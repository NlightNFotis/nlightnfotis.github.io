
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>GSOC: Week 5 report - Fotis Koutoulakis</title>
  <meta name="author" content="Fotis Koutoulakis">

  
  <meta name="description" content="GSOC: Week 5 Report Jul 24th, 2013 A clue! So last week we were left with the compiler test logs and the build results logs that we had to go &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://NlightNFotis.github.io/blog/2013/07/24/gsoc-week-5-report">
  <link href="/favicon.png" rel="icon">
  <link href='http://fonts.googleapis.com/css?family=Quicksand:300,400' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300' rel='stylesheet' type='text/css'>
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Fotis Koutoulakis" type="application/atom+xml">
  <script src="/js/jquery.js"></script>
  <script src="/js/bootstrap-collapse.js"></script>
  <script src="/js/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-42432516-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <div class="navbar navbar-inverse navbar-static-top">
  	<div class="navbar-inner">
  	  <div class="container">
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".navbar-responsive-collapse">
          <span class="fui-menu-24"></span>
        </a>
  	  	<div class="nav-collapse collapse navbar-responsive-collapse" style="height:0;">
  	      <ul class="nav">
    
        <li ><a href="/index.html">Home</a></li>
    
        <li ><a href="/blog/archives/index.html">Archives</a></li>
    
        <li ><a href="/about.html">About</a></li>
    
</ul>

<ul class="nav pull-right">
    
    <li><a href="http://github.com/NlightNFotis" title="Github Profile"><i class="icon-github-sign social-navbar"></i></a></li>
    
    
    
    <li><a href="http://twitter.com/NlightNFotis" title="Twitter Profile"><i class="icon-twitter-sign social-navbar"></i></a></li>
    
    
    <li><a href="http://plus.google.com/+FotisKoutoulakis" title="Google+ Profile"><i class="icon-google-plus-sign social-navbar"></i></a></li>
    
    
</ul>

  	    </div>
  	  </div>
  	</div>
  </div>
  <div class="container" id="main">
    <div class="span12">
      <div class="row-fluid">
        <div id="content">
          <div>
<article class="hentry" role="article">
  

  <header>
  <div class="jumbotron">
    GSOC: Week 5 Report
	<h5>








  


<i class="icon-calendar-empty"></i> <time datetime="2013-07-24T12:36:00+03:00" pubdate data-updated="true">Jul 24<span>th</span>, 2013</time></h5>
  </div>
</header>
  <div class="row-fluid">
    <div class="span12">
      <h1>A clue!</h1>

<p><strong>So last week we were left with the compiler test logs and the build results logs that we had to go through to checkout what was the root cause of all these failures in the gccgo test results, and more importantly in the libgo tests.</strong> So I went through the gccgo logs in search for a clue about why this may have happened. Here is the list of all the failures I compiled from the logs:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>spawn [open ...]^M
</span><span class='line'>doubleselect.x: ./pthread/pt-create.c:167: __pthread_create_internal: Assertion `({ mach_port_t ktid = __mach_thread_self (); int ok = thread-&gt;kernel_thread == ktid; __mach_port_deallocate ((__mach_task_s      elf_ + 0), ktid); ok; })' failed.
</span><span class='line'>FAIL: go.test/test/chan/doubleselect.go execution,  -O2 -g
</span><span class='line'>
</span><span class='line'>==========================================================
</span><span class='line'>
</span><span class='line'>spawn [open ...]^M
</span><span class='line'>nonblock.x: ./pthread/pt-create.c:167: __pthread_create_internal: Assertion `({ mach_port_t ktid = __mach_thread_self (); int ok = thread-&gt;kernel_thread == ktid; __mach_port_deallocate ((__mach_task_self_       + 0), ktid); ok; })' failed.
</span><span class='line'>FAIL: go.test/test/chan/nonblock.go execution,  -O2 -g
</span><span class='line'>
</span><span class='line'>==========================================================
</span><span class='line'>
</span><span class='line'>Executing on host: /root/gcc_new/gccbuild/gcc/testsuite/go/../../gccgo -B/root/gcc_new/gccbuild/gcc/testsuite/go/../../  -fno-diagnostics-show-caret -fdiagnostics-color=never  -I/root/gcc_new/gccbuild/i68      6-unknown-gnu0.3/./libgo  -fsplit-stack -c  -o split_stack376.o split_stack376.c    (timeout = 300)
</span><span class='line'>spawn /root/gcc_new/gccbuild/gcc/testsuite/go/../../gccgo -B/root/gcc_new/gccbuild/gcc/testsuite/go/../../ -fno-diagnostics-show-caret -fdiagnostics-color=never -I/root/gcc_new/gccbuild/i686-unknown-gnu0.      3/./libgo -fsplit-stack -c -o split_stack376.o split_stack376.c^M
</span><span class='line'>cc1: error: '-fsplit-stack' currently only supported on GNU/Linux^M
</span><span class='line'>cc1: error: '-fsplit-stack' is not supported by this compiler configuration^M
</span><span class='line'>compiler exited with status 1
</span><span class='line'>output is:
</span><span class='line'> cc1: error: '-fsplit-stack' currently only supported on GNU/Linux^M
</span><span class='line'> cc1: error: '-fsplit-stack' is not supported by this compiler configuration^M 
</span><span class='line'>
</span><span class='line'>UNTESTED: go.test/test/chan/select2.go
</span><span class='line'>
</span><span class='line'>==========================================================
</span><span class='line'>
</span><span class='line'>Setting LD_LIBRARY_PATH to .:/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo/.libs:/root/gcc_new/gccbuild/gcc:.:/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo/.libs:/root/gcc_new/gccbuild/gcc:/root      /gcc_new/gccbuild/./gmp/.libs:/root/gcc_new/gccbuild/./prev-gmp/.libs:/root/gcc_new/gccbuild/./mpfr/.libs:/root/gcc_new/gccbuild/./prev-mpfr/.libs:/root/gcc_new/gccbuild/./mpc/.libs:/root/gcc_new/gccbuild      /./prev-mpc/.libs
</span><span class='line'>spawn [open ...]^M
</span><span class='line'>select3.x: ./pthread/../sysdeps/generic/sem-timedwait.c:50: __sem_timedwait_internal: Assertion `({ mach_port_t ktid = __mach_thread_self (); int ok = thread-&gt;kernel_thread == ktid; __mach_port_deallocate       ((__mach_task_self_ + 0), ktid); ok; })' failed.
</span><span class='line'>Aborted
</span><span class='line'> 
</span><span class='line'>FAIL: go.test/test/chan/select3.go execution,  -O2 -g
</span><span class='line'>
</span><span class='line'>==========================================================
</span><span class='line'>
</span><span class='line'>Executing on host: /root/gcc_new/gccbuild/gcc/testsuite/go/../../gccgo -B/root/gcc_new/gccbuild/gcc/testsuite/go/../../ /root/gcc_new/gcc/gcc/testsuite/go.test/test/chan/select5.go  -fno-diagnostics-show-      caret -fdiagnostics-color=never  -I/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo  -O  -w  -pedantic-errors  -L/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo -L/root/gcc_new/gccbuild/i686-unknown-      gnu0.3/./libgo/.libs  -lm   -o select5.exe    (timeout = 300)
</span><span class='line'>spawn /root/gcc_new/gccbuild/gcc/testsuite/go/../../gccgo -B/root/gcc_new/gccbuild/gcc/testsuite/go/../../ /root/gcc_new/gcc/gcc/testsuite/go.test/test/chan/select5.go -fno-diagnostics-show-caret -fdiagno      stics-color=never -I/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo -O -w -pedantic-errors -L/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo -L/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo/.lib      s -lm -o select5.exe^M
</span><span class='line'>PASS: go.test/test/chan/select5.go -O (test for excess errors)
</span><span class='line'>FAIL: go.test/test/chan/select5.go execution
</span><span class='line'>
</span><span class='line'>==========================================================
</span><span class='line'>
</span><span class='line'>Setting LD_LIBRARY_PATH to .:/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo/.libs:/root/gcc_new/gccbuild/gcc:.:/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo/.libs:/root/gcc_new/gccbuild/gcc:/root      /gcc_new/gccbuild/./gmp/.libs:/root/gcc_new/gccbuild/./prev-gmp/.libs:/root/gcc_new/gccbuild/./mpfr/.libs:/root/gcc_new/gccbuild/./prev-mpfr/.libs:/root/gcc_new/gccbuild/./mpc/.libs:/root/gcc_new/gccbuild      /./prev-mpc/.libs
</span><span class='line'>spawn [open ...]^M
</span><span class='line'>bug147.x: ./pthread/../sysdeps/generic/sem-timedwait.c:50: __sem_timedwait_internal: Assertion `({ mach_port_t ktid = __mach_thread_self (); int ok = thread-&gt;kernel_thread == ktid; __mach_port_deallocate       ((__mach_task_self_ + 0), ktid); ok; })' failed.
</span><span class='line'>Aborted
</span><span class='line'> 
</span><span class='line'>FAIL: go.test/test/fixedbugs/bug147.go execution,  -O2 -g
</span><span class='line'>
</span><span class='line'>=========================================================
</span><span class='line'>
</span><span class='line'>Setting LD_LIBRARY_PATH to .:/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo/.libs:/root/gcc_new/gccbuild/gcc:.:/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo/.libs:/root/gcc_new/gccbuild/gcc:/root      /gcc_new/gccbuild/./gmp/.libs:/root/gcc_new/gccbuild/./prev-gmp/.libs:/root/gcc_new/gccbuild/./mpfr/.libs:/root/gcc_new/gccbuild/./prev-mpfr/.libs:/root/gcc_new/gccbuild/./mpc/.libs:/root/gcc_new/gccbuild      /./prev-mpc/.libs
</span><span class='line'>spawn [open ...]^M
</span><span class='line'>BUG: bug347: cannot find caller
</span><span class='line'>Aborted
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'>FAIL: go.test/test/fixedbugs/bug347.go execution,  -O0 -g
</span><span class='line'>
</span><span class='line'>========================================================
</span><span class='line'>
</span><span class='line'>Setting LD_LIBRARY_PATH to .:/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo/.libs:/root/gcc_new/gccbuild/gcc:.:/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo/.libs:/root/gcc_new/gccbuild/gcc:/root      /gcc_new/gccbuild/./gmp/.libs:/root/gcc_new/gccbuild/./prev-gmp/.libs:/root/gcc_new/gccbuild/./mpfr/.libs:/root/gcc_new/gccbuild/./prev-mpfr/.libs:/root/gcc_new/gccbuild/./mpc/.libs:/root/gcc_new/gccbuild      /./prev-mpc/.libs
</span><span class='line'>spawn [open ...]^M
</span><span class='line'>BUG: bug348: cannot find caller
</span><span class='line'>panic: runtime error: invalid memory address or nil pointer dereference
</span><span class='line'>[signal 0xb code=0x2 addr=0x0]
</span><span class='line'> 
</span><span class='line'>goroutine 1 [running]:
</span><span class='line'>FAIL: go.test/test/fixedbugs/bug348.go execution,  -O0 -g
</span><span class='line'>
</span><span class='line'>========================================================
</span><span class='line'>
</span><span class='line'>Setting LD_LIBRARY_PATH to .:/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo/.libs:/root/gcc_new/gccbuild/gcc:.:/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo/.libs:/root/gcc_new/gccbuild/gcc:/root      /gcc_new/gccbuild/./gmp/.libs:/root/gcc_new/gccbuild/./prev-gmp/.libs:/root/gcc_new/gccbuild/./mpfr/.libs:/root/gcc_new/gccbuild/./prev-mpfr/.libs:/root/gcc_new/gccbuild/./mpc/.libs:/root/gcc_new/gccbuild      /./prev-mpc/.libs
</span><span class='line'>spawn [open ...]^M
</span><span class='line'>mallocfin.x: ./pthread/pt-create.c:167: __pthread_create_internal: Assertion `({ mach_port_t ktid = __mach_thread_self (); int ok = thread-&gt;kernel_thread == ktid; __mach_port_deallocate ((__mach_task_self      _ + 0), ktid); ok; })' failed.
</span><span class='line'>FAIL: go.test/test/mallocfin.go execution,  -O2 -g
</span><span class='line'>
</span><span class='line'>=======================================================
</span><span class='line'>
</span><span class='line'>Setting LD_LIBRARY_PATH to .:/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo/.libs:/root/gcc_new/gccbuild/gcc:.:/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo/.libs:/root/gcc_new/gccbuild/gcc:/root      /gcc_new/gccbuild/./gmp/.libs:/root/gcc_new/gccbuild/./prev-gmp/.libs:/root/gcc_new/gccbuild/./mpfr/.libs:/root/gcc_new/gccbuild/./prev-mpfr/.libs:/root/gcc_new/gccbuild/./mpc/.libs:/root/gcc_new/gccbuild      /./prev-mpc/.libs
</span><span class='line'>spawn [open ...]^M
</span><span class='line'>Aborted
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'>FAIL: go.test/test/nil.go execution,  -O2 -g
</span><span class='line'>
</span><span class='line'>======================================================
</span><span class='line'>
</span><span class='line'>Setting LD_LIBRARY_PATH to .:/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo/.libs:/root/gcc_new/gccbuild/gcc:.:/root/gcc_new/gccbuild/i686-unknown-gnu0.3/./libgo/.libs:/root/gcc_new/gccbuild/gcc:/root      /gcc_new/gccbuild/./gmp/.libs:/root/gcc_new/gccbuild/./prev-gmp/.libs:/root/gcc_new/gccbuild/./mpfr/.libs:/root/gcc_new/gccbuild/./prev-mpfr/.libs:/root/gcc_new/gccbuild/./mpc/.libs:/root/gcc_new/gccbuild      /./prev-mpc/.libs
</span><span class='line'>spawn [open ...]^M
</span><span class='line'>Aborted
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'>FAIL: go.test/test/recover3.go execution,  -O2 -g
</span></code></pre></td></tr></table></div></figure>


<p><em>See a pattern there?</em> Well certainly I do. In several occasions, the root cause for the fail is this:</p>

<figure class='code'><figcaption><span>Assertion fail</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">Assertion</span> <span class="err">`</span><span class="p">({</span> <span class="n">mach_port_t</span> <span class="n">ktid</span> <span class="o">=</span> <span class="n">__mach_thread_self</span> <span class="p">();</span> <span class="kt">int</span> <span class="n">ok</span> <span class="o">=</span> <span class="kr">thread</span><span class="o">-&gt;</span><span class="n">kernel_thread</span> <span class="o">==</span> <span class="n">ktid</span><span class="p">;</span> <span class="n">__mach_port_deallocate</span>       <span class="p">((</span><span class="n">__mach_task_self_</span> <span class="o">+</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ktid</span><span class="p">);</span> <span class="n">ok</span><span class="p">;</span> <span class="p">})</span><span class="err">&#39;</span> <span class="n">failed</span><span class="p">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>Hmm&hellip; That&rsquo;s interesting. Let us go through the libgo results too.</p>

<figure class='code'><figcaption><span>Assertion fail</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">Test</span> <span class="n">Run</span> <span class="n">By</span> <span class="n">root</span> <span class="n">on</span> <span class="n">Fri</span> <span class="n">Jul</span> <span class="mi">12</span> <span class="mi">17</span><span class="o">:</span><span class="mi">56</span><span class="o">:</span><span class="mi">44</span> <span class="n">UTC</span> <span class="mi">2013</span>
</span><span class='line'><span class="n">Native</span> <span class="n">configuration</span> <span class="n">is</span> <span class="n">i686</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">gnu0</span><span class="mf">.3</span>
</span><span class='line'>
</span><span class='line'>      <span class="o">===</span> <span class="n">libgo</span> <span class="n">tests</span> <span class="o">===</span>
</span><span class='line'>
</span><span class='line'><span class="n">a</span><span class="p">.</span><span class="n">out</span><span class="o">:</span> <span class="p">.</span><span class="o">/</span><span class="n">pthread</span><span class="o">/</span><span class="n">pt</span><span class="o">-</span><span class="n">create</span><span class="p">.</span><span class="n">c</span><span class="o">:</span><span class="mi">167</span><span class="o">:</span> <span class="n">__pthread_create_internal</span><span class="o">:</span> <span class="n">Assertion</span> <span class="err">`</span><span class="p">({</span> <span class="n">mach_port_t</span> <span class="n">ktid</span> <span class="o">=</span> <span class="n">__mach_thread_self</span> <span class="p">();</span> <span class="kt">int</span> <span class="n">ok</span> <span class="o">=</span> <span class="kr">thread</span><span class="o">-&gt;</span><span class="n">kernel_thread</span> <span class="o">==</span> <span class="n">ktid</span><span class="p">;</span> <span class="n">__mach_port_deallocate</span> <span class="p">((</span><span class="n">__mach_task_self_</span> <span class="o">+</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ktid</span><span class="p">);</span> <span class="n">ok</span><span class="p">;</span> <span class="p">})</span><span class="err">&#39;</span> <span class="n">failed</span><span class="p">.</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">486</span><span class="o">:</span> <span class="mi">10005</span> <span class="n">Aborted</span>                 <span class="p">.</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="n">out</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="kt">short</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="n">timeout</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">timeout</span><span class="p">}</span><span class="n">s</span> <span class="s">&quot;$@&quot;</span>
</span><span class='line'><span class="nl">FAIL:</span> <span class="n">bufio</span>
</span><span class='line'><span class="n">timed</span> <span class="n">out</span> <span class="n">in</span> <span class="n">gotest</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">484</span><span class="o">:</span> <span class="n">kill</span><span class="o">:</span> <span class="p">(</span><span class="mi">10005</span><span class="p">)</span> <span class="o">-</span> <span class="n">No</span> <span class="n">such</span> <span class="n">process</span>
</span><span class='line'><span class="n">a</span><span class="p">.</span><span class="n">out</span><span class="o">:</span> <span class="p">.</span><span class="o">/</span><span class="n">pthread</span><span class="o">/</span><span class="n">pt</span><span class="o">-</span><span class="n">create</span><span class="p">.</span><span class="n">c</span><span class="o">:</span><span class="mi">167</span><span class="o">:</span> <span class="n">__pthread_create_internal</span><span class="o">:</span> <span class="n">Assertion</span> <span class="err">`</span><span class="p">({</span> <span class="n">mach_port_t</span> <span class="n">ktid</span> <span class="o">=</span> <span class="n">__mach_thread_self</span> <span class="p">();</span> <span class="kt">int</span> <span class="n">ok</span> <span class="o">=</span> <span class="kr">thread</span><span class="o">-&gt;</span><span class="n">kernel_thread</span> <span class="o">==</span> <span class="n">ktid</span><span class="p">;</span> <span class="n">__mach_port_deallocate</span> <span class="p">((</span><span class="n">__mach_task_self_</span> <span class="o">+</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ktid</span><span class="p">);</span> <span class="n">ok</span><span class="p">;</span> <span class="p">})</span><span class="err">&#39;</span> <span class="n">failed</span><span class="p">.</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">486</span><span class="o">:</span> <span class="mi">10637</span> <span class="n">Aborted</span>                 <span class="p">.</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="n">out</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="kt">short</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="n">timeout</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">timeout</span><span class="p">}</span><span class="n">s</span> <span class="s">&quot;$@&quot;</span>
</span><span class='line'><span class="nl">FAIL:</span> <span class="n">bytes</span>
</span><span class='line'><span class="n">timed</span> <span class="n">out</span> <span class="n">in</span> <span class="n">gotest</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">484</span><span class="o">:</span> <span class="n">kill</span><span class="o">:</span> <span class="p">(</span><span class="mi">10637</span><span class="p">)</span> <span class="o">-</span> <span class="n">No</span> <span class="n">such</span> <span class="n">process</span>
</span><span class='line'><span class="n">a</span><span class="p">.</span><span class="n">out</span><span class="o">:</span> <span class="p">.</span><span class="o">/</span><span class="n">pthread</span><span class="o">/</span><span class="n">pt</span><span class="o">-</span><span class="n">create</span><span class="p">.</span><span class="n">c</span><span class="o">:</span><span class="mi">167</span><span class="o">:</span> <span class="n">__pthread_create_internal</span><span class="o">:</span> <span class="n">Assertion</span> <span class="err">`</span><span class="p">({</span> <span class="n">mach_port_t</span> <span class="n">ktid</span> <span class="o">=</span> <span class="n">__mach_thread_self</span> <span class="p">();</span> <span class="kt">int</span> <span class="n">ok</span> <span class="o">=</span> <span class="kr">thread</span><span class="o">-&gt;</span><span class="n">kernel_thread</span> <span class="o">==</span> <span class="n">ktid</span><span class="p">;</span> <span class="n">__mach_port_deallocate</span> <span class="p">((</span><span class="n">__mach_task_self_</span> <span class="o">+</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ktid</span><span class="p">);</span> <span class="n">ok</span><span class="p">;</span> <span class="p">})</span><span class="err">&#39;</span> <span class="n">failed</span><span class="p">.</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">486</span><span class="o">:</span> <span class="mi">10757</span> <span class="n">Aborted</span>                 <span class="p">.</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="n">out</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="kt">short</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="n">timeout</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">timeout</span><span class="p">}</span><span class="n">s</span> <span class="s">&quot;$@&quot;</span>
</span><span class='line'><span class="nl">FAIL:</span> <span class="n">errors</span>
</span><span class='line'><span class="n">timed</span> <span class="n">out</span> <span class="n">in</span> <span class="n">gotest</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">484</span><span class="o">:</span> <span class="n">kill</span><span class="o">:</span> <span class="p">(</span><span class="mi">10757</span><span class="p">)</span> <span class="o">-</span> <span class="n">No</span> <span class="n">such</span> <span class="n">process</span>
</span><span class='line'><span class="n">a</span><span class="p">.</span><span class="n">out</span><span class="o">:</span> <span class="p">.</span><span class="o">/</span><span class="n">pthread</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">sysdeps</span><span class="o">/</span><span class="n">generic</span><span class="o">/</span><span class="n">sem</span><span class="o">-</span><span class="n">timedwait</span><span class="p">.</span><span class="n">c</span><span class="o">:</span><span class="mi">50</span><span class="o">:</span> <span class="n">__sem_timedwait_internal</span><span class="o">:</span> <span class="n">Assertion</span> <span class="err">`</span><span class="p">({</span> <span class="n">mach_port_t</span> <span class="n">ktid</span> <span class="o">=</span> <span class="n">__mach_thread_self</span> <span class="p">();</span> <span class="kt">int</span> <span class="n">ok</span> <span class="o">=</span> <span class="kr">thread</span><span class="o">-&gt;</span><span class="n">kernel_thread</span> <span class="o">==</span> <span class="n">ktid</span><span class="p">;</span> <span class="n">__mach_port_deallocate</span> <span class="p">((</span><span class="n">__mach_task_self_</span> <span class="o">+</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ktid</span><span class="p">);</span> <span class="n">ok</span><span class="p">;</span> <span class="p">})</span><span class="err">&#39;</span> <span class="n">failed</span><span class="p">.</span>
</span><span class='line'><span class="n">Aborted</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="n">goroutine</span> <span class="mi">1</span> <span class="p">[</span><span class="n">syscall</span><span class="p">]</span><span class="o">:</span>
</span><span class='line'><span class="n">no</span> <span class="n">stack</span> <span class="n">trace</span> <span class="n">available</span>
</span><span class='line'><span class="nl">FAIL:</span> <span class="n">expvar</span>
</span><span class='line'><span class="n">timed</span> <span class="n">out</span> <span class="n">in</span> <span class="n">gotest</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">484</span><span class="o">:</span> <span class="n">kill</span><span class="o">:</span> <span class="p">(</span><span class="mi">10886</span><span class="p">)</span> <span class="o">-</span> <span class="n">No</span> <span class="n">such</span> <span class="n">process</span>
</span><span class='line'><span class="n">a</span><span class="p">.</span><span class="n">out</span><span class="o">:</span> <span class="p">.</span><span class="o">/</span><span class="n">pthread</span><span class="o">/</span><span class="n">pt</span><span class="o">-</span><span class="n">create</span><span class="p">.</span><span class="n">c</span><span class="o">:</span><span class="mi">167</span><span class="o">:</span> <span class="n">__pthread_create_internal</span><span class="o">:</span> <span class="n">Assertion</span> <span class="err">`</span><span class="p">({</span> <span class="n">mach_port_t</span> <span class="n">ktid</span> <span class="o">=</span> <span class="n">__mach_thread_self</span> <span class="p">();</span> <span class="kt">int</span> <span class="n">ok</span> <span class="o">=</span> <span class="kr">thread</span><span class="o">-&gt;</span><span class="n">kernel_thread</span> <span class="o">==</span> <span class="n">ktid</span><span class="p">;</span> <span class="n">__mach_port_deallocate</span> <span class="p">((</span><span class="n">__mach_task_self_</span> <span class="o">+</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ktid</span><span class="p">);</span> <span class="n">ok</span><span class="p">;</span> <span class="p">})</span><span class="err">&#39;</span> <span class="n">failed</span><span class="p">.</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">486</span><span class="o">:</span> <span class="mi">11058</span> <span class="n">Aborted</span>                 <span class="p">.</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="n">out</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="kt">short</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="n">timeout</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">timeout</span><span class="p">}</span><span class="n">s</span> <span class="s">&quot;$@&quot;</span>
</span><span class='line'><span class="nl">FAIL:</span> <span class="n">flag</span>
</span><span class='line'><span class="n">timed</span> <span class="n">out</span> <span class="n">in</span> <span class="n">gotest</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">484</span><span class="o">:</span> <span class="n">kill</span><span class="o">:</span> <span class="p">(</span><span class="mi">11058</span><span class="p">)</span> <span class="o">-</span> <span class="n">No</span> <span class="n">such</span> <span class="n">process</span>
</span><span class='line'><span class="n">a</span><span class="p">.</span><span class="n">out</span><span class="o">:</span> <span class="p">.</span><span class="o">/</span><span class="n">pthread</span><span class="o">/</span><span class="n">pt</span><span class="o">-</span><span class="n">create</span><span class="p">.</span><span class="n">c</span><span class="o">:</span><span class="mi">167</span><span class="o">:</span> <span class="n">__pthread_create_internal</span><span class="o">:</span> <span class="n">Assertion</span> <span class="err">`</span><span class="p">({</span> <span class="n">mach_port_t</span> <span class="n">ktid</span> <span class="o">=</span> <span class="n">__mach_thread_self</span> <span class="p">();</span> <span class="kt">int</span> <span class="n">ok</span> <span class="o">=</span> <span class="kr">thread</span><span class="o">-&gt;</span><span class="n">kernel_thread</span> <span class="o">==</span> <span class="n">ktid</span><span class="p">;</span> <span class="n">__mach_port_deallocate</span> <span class="p">((</span><span class="n">__mach_task_self_</span> <span class="o">+</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ktid</span><span class="p">);</span> <span class="n">ok</span><span class="p">;</span> <span class="p">})</span><span class="err">&#39;</span> <span class="n">failed</span><span class="p">.</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">486</span><span class="o">:</span> <span class="mi">11475</span> <span class="n">Aborted</span>                 <span class="p">.</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="n">out</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="kt">short</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="n">timeout</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">timeout</span><span class="p">}</span><span class="n">s</span> <span class="s">&quot;$@&quot;</span>
</span><span class='line'><span class="nl">FAIL:</span> <span class="n">fmt</span>
</span><span class='line'><span class="n">timed</span> <span class="n">out</span> <span class="n">in</span> <span class="n">gotest</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">484</span><span class="o">:</span> <span class="n">kill</span><span class="o">:</span> <span class="p">(</span><span class="mi">11475</span><span class="p">)</span> <span class="o">-</span> <span class="n">No</span> <span class="n">such</span> <span class="n">process</span>
</span><span class='line'><span class="n">a</span><span class="p">.</span><span class="n">out</span><span class="o">:</span> <span class="p">.</span><span class="o">/</span><span class="n">pthread</span><span class="o">/</span><span class="n">pt</span><span class="o">-</span><span class="n">create</span><span class="p">.</span><span class="n">c</span><span class="o">:</span><span class="mi">167</span><span class="o">:</span> <span class="n">__pthread_create_internal</span><span class="o">:</span> <span class="n">Assertion</span> <span class="err">`</span><span class="p">({</span> <span class="n">mach_port_t</span> <span class="n">ktid</span> <span class="o">=</span> <span class="n">__mach_thread_self</span> <span class="p">();</span> <span class="kt">int</span> <span class="n">ok</span> <span class="o">=</span> <span class="kr">thread</span><span class="o">-&gt;</span><span class="n">kernel_thread</span> <span class="o">==</span> <span class="n">ktid</span><span class="p">;</span> <span class="n">__mach_port_deallocate</span> <span class="p">((</span><span class="n">__mach_task_self_</span> <span class="o">+</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ktid</span><span class="p">);</span> <span class="n">ok</span><span class="p">;</span> <span class="p">})</span><span class="err">&#39;</span> <span class="n">failed</span><span class="p">.</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">486</span><span class="o">:</span> <span class="mi">11584</span> <span class="n">Aborted</span>                 <span class="p">.</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="n">out</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="kt">short</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="n">timeout</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">timeout</span><span class="p">}</span><span class="n">s</span> <span class="s">&quot;$@&quot;</span>
</span><span class='line'><span class="nl">FAIL:</span> <span class="n">html</span>
</span><span class='line'><span class="n">timed</span> <span class="n">out</span> <span class="n">in</span> <span class="n">gotest</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">484</span><span class="o">:</span> <span class="n">kill</span><span class="o">:</span> <span class="p">(</span><span class="mi">11584</span><span class="p">)</span> <span class="o">-</span> <span class="n">No</span> <span class="n">such</span> <span class="n">process</span>
</span><span class='line'><span class="n">a</span><span class="p">.</span><span class="n">out</span><span class="o">:</span> <span class="p">.</span><span class="o">/</span><span class="n">pthread</span><span class="o">/</span><span class="n">pt</span><span class="o">-</span><span class="n">create</span><span class="p">.</span><span class="n">c</span><span class="o">:</span><span class="mi">167</span><span class="o">:</span> <span class="n">__pthread_create_internal</span><span class="o">:</span> <span class="n">Assertion</span> <span class="err">`</span><span class="p">({</span> <span class="n">mach_port_t</span> <span class="n">ktid</span> <span class="o">=</span> <span class="n">__mach_thread_self</span> <span class="p">();</span> <span class="kt">int</span> <span class="n">ok</span> <span class="o">=</span> <span class="kr">thread</span><span class="o">-&gt;</span><span class="n">kernel_thread</span> <span class="o">==</span> <span class="n">ktid</span><span class="p">;</span> <span class="n">__mach_port_deallocate</span> <span class="p">((</span><span class="n">__mach_task_self_</span> <span class="o">+</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ktid</span><span class="p">);</span> <span class="n">ok</span><span class="p">;</span> <span class="p">})</span><span class="err">&#39;</span> <span class="n">failed</span><span class="p">.</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">486</span><span class="o">:</span> <span class="mi">11747</span> <span class="n">Aborted</span>                 <span class="p">.</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="n">out</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="kt">short</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="n">timeout</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">timeout</span><span class="p">}</span><span class="n">s</span> <span class="s">&quot;$@&quot;</span>
</span><span class='line'><span class="nl">FAIL:</span> <span class="n">image</span>
</span><span class='line'><span class="n">timed</span> <span class="n">out</span> <span class="n">in</span> <span class="n">gotest</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">484</span><span class="o">:</span> <span class="n">kill</span><span class="o">:</span> <span class="p">(</span><span class="mi">11747</span><span class="p">)</span> <span class="o">-</span> <span class="n">No</span> <span class="n">such</span> <span class="n">process</span>
</span><span class='line'><span class="n">a</span><span class="p">.</span><span class="n">out</span><span class="o">:</span> <span class="p">.</span><span class="o">/</span><span class="n">pthread</span><span class="o">/</span><span class="n">pt</span><span class="o">-</span><span class="n">create</span><span class="p">.</span><span class="n">c</span><span class="o">:</span><span class="mi">167</span><span class="o">:</span> <span class="n">__pthread_create_internal</span><span class="o">:</span> <span class="n">Assertion</span> <span class="err">`</span><span class="p">({</span> <span class="n">mach_port_t</span> <span class="n">ktid</span> <span class="o">=</span> <span class="n">__mach_thread_self</span> <span class="p">();</span> <span class="kt">int</span> <span class="n">ok</span> <span class="o">=</span> <span class="kr">thread</span><span class="o">-&gt;</span><span class="n">kernel_thread</span> <span class="o">==</span> <span class="n">ktid</span><span class="p">;</span> <span class="n">__mach_port_deallocate</span> <span class="p">((</span><span class="n">__mach_task_self_</span> <span class="o">+</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ktid</span><span class="p">);</span> <span class="n">ok</span><span class="p">;</span> <span class="p">})</span><span class="err">&#39;</span> <span class="n">failed</span><span class="p">.</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">486</span><span class="o">:</span> <span class="mi">11999</span> <span class="n">Aborted</span>                 <span class="p">.</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="n">out</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="kt">short</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="n">timeout</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">timeout</span><span class="p">}</span><span class="n">s</span> <span class="s">&quot;$@&quot;</span>
</span><span class='line'><span class="nl">FAIL:</span> <span class="n">io</span>
</span><span class='line'><span class="n">timed</span> <span class="n">out</span> <span class="n">in</span> <span class="n">gotest</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">484</span><span class="o">:</span> <span class="n">kill</span><span class="o">:</span> <span class="p">(</span><span class="mi">11999</span><span class="p">)</span> <span class="o">-</span> <span class="n">No</span> <span class="n">such</span> <span class="n">process</span>
</span><span class='line'><span class="n">a</span><span class="p">.</span><span class="n">out</span><span class="o">:</span> <span class="p">.</span><span class="o">/</span><span class="n">pthread</span><span class="o">/</span><span class="n">pt</span><span class="o">-</span><span class="n">create</span><span class="p">.</span><span class="n">c</span><span class="o">:</span><span class="mi">167</span><span class="o">:</span> <span class="n">__pthread_create_internal</span><span class="o">:</span> <span class="n">Assertion</span> <span class="err">`</span><span class="p">({</span> <span class="n">mach_port_t</span> <span class="n">ktid</span> <span class="o">=</span> <span class="n">__mach_thread_self</span> <span class="p">();</span> <span class="kt">int</span> <span class="n">ok</span> <span class="o">=</span> <span class="kr">thread</span><span class="o">-&gt;</span><span class="n">kernel_thread</span> <span class="o">==</span> <span class="n">ktid</span><span class="p">;</span> <span class="n">__mach_port_deallocate</span> <span class="p">((</span><span class="n">__mach_task_self_</span> <span class="o">+</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ktid</span><span class="p">);</span> <span class="n">ok</span><span class="p">;</span> <span class="p">})</span><span class="err">&#39;</span> <span class="n">failed</span><span class="p">.</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">486</span><span class="o">:</span> <span class="mi">12116</span> <span class="n">Aborted</span>                 <span class="p">.</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="n">out</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="kt">short</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="n">timeout</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">timeout</span><span class="p">}</span><span class="n">s</span> <span class="s">&quot;$@&quot;</span>
</span><span class='line'><span class="nl">FAIL:</span> <span class="n">log</span>
</span><span class='line'><span class="n">timed</span> <span class="n">out</span> <span class="n">in</span> <span class="n">gotest</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">484</span><span class="o">:</span> <span class="n">kill</span><span class="o">:</span> <span class="p">(</span><span class="mi">12116</span><span class="p">)</span> <span class="o">-</span> <span class="n">No</span> <span class="n">such</span> <span class="n">process</span>
</span><span class='line'><span class="n">a</span><span class="p">.</span><span class="n">out</span><span class="o">:</span> <span class="p">.</span><span class="o">/</span><span class="n">pthread</span><span class="o">/</span><span class="n">pt</span><span class="o">-</span><span class="n">create</span><span class="p">.</span><span class="n">c</span><span class="o">:</span><span class="mi">167</span><span class="o">:</span> <span class="n">__pthread_create_internal</span><span class="o">:</span> <span class="n">Assertion</span> <span class="err">`</span><span class="p">({</span> <span class="n">mach_port_t</span> <span class="n">ktid</span> <span class="o">=</span> <span class="n">__mach_thread_self</span> <span class="p">();</span> <span class="kt">int</span> <span class="n">ok</span> <span class="o">=</span> <span class="kr">thread</span><span class="o">-&gt;</span><span class="n">kernel_thread</span> <span class="o">==</span> <span class="n">ktid</span><span class="p">;</span> <span class="n">__mach_port_deallocate</span> <span class="p">((</span><span class="n">__mach_task_self_</span> <span class="o">+</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ktid</span><span class="p">);</span> <span class="n">ok</span><span class="p">;</span> <span class="p">})</span><span class="err">&#39;</span> <span class="n">failed</span><span class="p">.</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">486</span><span class="o">:</span> <span class="mi">13107</span> <span class="n">Aborted</span>                 <span class="p">.</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="n">out</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="kt">short</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="n">timeout</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">timeout</span><span class="p">}</span><span class="n">s</span> <span class="s">&quot;$@&quot;</span>
</span><span class='line'><span class="nl">FAIL:</span> <span class="n">math</span>
</span><span class='line'><span class="n">timed</span> <span class="n">out</span> <span class="n">in</span> <span class="n">gotest</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">484</span><span class="o">:</span> <span class="n">kill</span><span class="o">:</span> <span class="p">(</span><span class="mi">13107</span><span class="p">)</span> <span class="o">-</span> <span class="n">No</span> <span class="n">such</span> <span class="n">process</span>
</span><span class='line'><span class="n">a</span><span class="p">.</span><span class="n">out</span><span class="o">:</span> <span class="p">.</span><span class="o">/</span><span class="n">pthread</span><span class="o">/</span><span class="n">pt</span><span class="o">-</span><span class="n">create</span><span class="p">.</span><span class="n">c</span><span class="o">:</span><span class="mi">167</span><span class="o">:</span> <span class="n">__pthread_create_internal</span><span class="o">:</span> <span class="n">Assertion</span> <span class="err">`</span><span class="p">({</span> <span class="n">mach_port_t</span> <span class="n">ktid</span> <span class="o">=</span> <span class="n">__mach_thread_self</span> <span class="p">();</span> <span class="kt">int</span> <span class="n">ok</span> <span class="o">=</span> <span class="kr">thread</span><span class="o">-&gt;</span><span class="n">kernel_thread</span> <span class="o">==</span> <span class="n">ktid</span><span class="p">;</span> <span class="n">__mach_port_deallocate</span> <span class="p">((</span><span class="n">__mach_task_self_</span> <span class="o">+</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ktid</span><span class="p">);</span> <span class="n">ok</span><span class="p">;</span> <span class="p">})</span><span class="err">&#39;</span> <span class="n">failed</span><span class="p">.</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">486</span><span class="o">:</span> <span class="mi">13271</span> <span class="n">Aborted</span>                 <span class="p">.</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="n">out</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="kt">short</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="n">timeout</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">timeout</span><span class="p">}</span><span class="n">s</span> <span class="s">&quot;$@&quot;</span>
</span><span class='line'><span class="nl">FAIL:</span> <span class="n">mime</span>
</span><span class='line'><span class="n">timed</span> <span class="n">out</span> <span class="n">in</span> <span class="n">gotest</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">484</span><span class="o">:</span> <span class="n">kill</span><span class="o">:</span> <span class="p">(</span><span class="mi">13271</span><span class="p">)</span> <span class="o">-</span> <span class="n">No</span> <span class="n">such</span> <span class="n">process</span>
</span><span class='line'><span class="n">a</span><span class="p">.</span><span class="n">out</span><span class="o">:</span> <span class="p">.</span><span class="o">/</span><span class="n">pthread</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">sysdeps</span><span class="o">/</span><span class="n">generic</span><span class="o">/</span><span class="n">sem</span><span class="o">-</span><span class="n">timedwait</span><span class="p">.</span><span class="n">c</span><span class="o">:</span><span class="mi">50</span><span class="o">:</span> <span class="n">__sem_timedwait_internal</span><span class="o">:</span> <span class="n">Assertion</span> <span class="err">`</span><span class="p">({</span> <span class="n">mach_port_t</span> <span class="n">ktid</span> <span class="o">=</span> <span class="n">__mach_thread_self</span> <span class="p">();</span> <span class="kt">int</span> <span class="n">ok</span> <span class="o">=</span> <span class="kr">thread</span><span class="o">-&gt;</span><span class="n">kernel_thread</span> <span class="o">==</span> <span class="n">ktid</span><span class="p">;</span> <span class="n">__mach_port_deallocate</span> <span class="p">((</span><span class="n">__mach_task_self_</span> <span class="o">+</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ktid</span><span class="p">);</span> <span class="n">ok</span><span class="p">;</span> <span class="p">})</span><span class="err">&#39;</span> <span class="n">failed</span><span class="p">.</span>
</span><span class='line'><span class="n">Aborted</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="n">goroutine</span> <span class="mi">1</span> <span class="p">[</span><span class="n">chan</span> <span class="n">receive</span><span class="p">]</span><span class="o">:</span>
</span><span class='line'><span class="n">a</span><span class="p">.</span><span class="n">out</span><span class="o">:</span> <span class="p">.</span><span class="o">/</span><span class="n">pthread</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">sysdeps</span><span class="o">/</span><span class="n">generic</span><span class="o">/</span><span class="n">sem</span><span class="o">-</span><span class="n">timedwait</span><span class="p">.</span><span class="n">c</span><span class="o">:</span><span class="mi">50</span><span class="o">:</span> <span class="n">__sem_timedwait_internal</span><span class="o">:</span> <span class="n">Assertion</span> <span class="err">`</span><span class="p">({</span> <span class="n">mach_port_t</span> <span class="n">ktid</span> <span class="o">=</span> <span class="n">__mach_thread_self</span> <span class="p">();</span> <span class="kt">int</span> <span class="n">ok</span> <span class="o">=</span> <span class="kr">thread</span><span class="o">-&gt;</span><span class="n">kernel_thread</span> <span class="o">==</span> <span class="n">ktid</span><span class="p">;</span> <span class="n">__mach_port_deallocate</span> <span class="p">((</span><span class="n">__mach_task_self_</span> <span class="o">+</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ktid</span><span class="p">);</span> <span class="n">ok</span><span class="p">;</span> <span class="p">})</span><span class="err">&#39;</span> <span class="n">failed</span><span class="p">.</span>
</span><span class='line'><span class="n">panic</span> <span class="n">during</span> <span class="n">panic</span>
</span><span class='line'><span class="n">testing</span><span class="p">.</span><span class="n">RunTestsFAIL</span><span class="o">:</span> <span class="n">net</span>
</span><span class='line'><span class="n">timed</span> <span class="n">out</span> <span class="n">in</span> <span class="n">gotest</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">484</span><span class="o">:</span> <span class="n">kill</span><span class="o">:</span> <span class="p">(</span><span class="mi">14234</span><span class="p">)</span> <span class="o">-</span> <span class="n">No</span> <span class="n">such</span> <span class="n">process</span>
</span><span class='line'><span class="n">a</span><span class="p">.</span><span class="n">out</span><span class="o">:</span> <span class="p">.</span><span class="o">/</span><span class="n">pthread</span><span class="o">/</span><span class="n">pt</span><span class="o">-</span><span class="n">create</span><span class="p">.</span><span class="n">c</span><span class="o">:</span><span class="mi">167</span><span class="o">:</span> <span class="n">__pthread_create_internal</span><span class="o">:</span> <span class="n">Assertion</span> <span class="err">`</span><span class="p">({</span> <span class="n">mach_port_t</span> <span class="n">ktid</span> <span class="o">=</span> <span class="n">__mach_thread_self</span> <span class="p">();</span> <span class="kt">int</span> <span class="n">ok</span> <span class="o">=</span> <span class="kr">thread</span><span class="o">-&gt;</span><span class="n">kernel_thread</span> <span class="o">==</span> <span class="n">ktid</span><span class="p">;</span> <span class="n">__mach_port_deallocate</span> <span class="p">((</span><span class="n">__mach_task_self_</span> <span class="o">+</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ktid</span><span class="p">);</span> <span class="n">ok</span><span class="p">;</span> <span class="p">})</span><span class="err">&#39;</span> <span class="n">failed</span><span class="p">.</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">486</span><span class="o">:</span> <span class="mi">14699</span> <span class="n">Aborted</span>                 <span class="p">.</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="n">out</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="kt">short</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="n">timeout</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">timeout</span><span class="p">}</span><span class="n">s</span> <span class="s">&quot;$@&quot;</span>
</span><span class='line'><span class="nl">FAIL:</span> <span class="n">os</span>
</span><span class='line'><span class="n">timed</span> <span class="n">out</span> <span class="n">in</span> <span class="n">gotest</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">484</span><span class="o">:</span> <span class="n">kill</span><span class="o">:</span> <span class="p">(</span><span class="mi">14699</span><span class="p">)</span> <span class="o">-</span> <span class="n">No</span> <span class="n">such</span> <span class="n">process</span>
</span><span class='line'><span class="n">a</span><span class="p">.</span><span class="n">out</span><span class="o">:</span> <span class="p">.</span><span class="o">/</span><span class="n">pthread</span><span class="o">/</span><span class="n">pt</span><span class="o">-</span><span class="n">create</span><span class="p">.</span><span class="n">c</span><span class="o">:</span><span class="mi">167</span><span class="o">:</span> <span class="n">__pthread_create_internal</span><span class="o">:</span> <span class="n">Assertion</span> <span class="err">`</span><span class="p">({</span> <span class="n">mach_port_t</span> <span class="n">ktid</span> <span class="o">=</span> <span class="n">__mach_thread_self</span> <span class="p">();</span> <span class="kt">int</span> <span class="n">ok</span> <span class="o">=</span> <span class="kr">thread</span><span class="o">-&gt;</span><span class="n">kernel_thread</span> <span class="o">==</span> <span class="n">ktid</span><span class="p">;</span> <span class="n">__mach_port_deallocate</span> <span class="p">((</span><span class="n">__mach_task_self_</span> <span class="o">+</span> <span class="mi">0</span><span class="p">),</span> <span class="n">ktid</span><span class="p">);</span> <span class="n">ok</span><span class="p">;</span> <span class="p">})</span><span class="err">&#39;</span> <span class="n">failed</span><span class="p">.</span>
</span><span class='line'><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">gcc</span><span class="o">/</span><span class="n">libgo</span><span class="o">/</span><span class="n">testsuite</span><span class="o">/</span><span class="n">gotest</span><span class="o">:</span> <span class="n">line</span> <span class="mi">486</span><span class="o">:</span> <span class="mi">14860</span> <span class="n">Aborted</span>                 <span class="p">.</span><span class="o">/</span><span class="n">a</span><span class="p">.</span><span class="n">out</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="kt">short</span> <span class="o">-</span><span class="n">test</span><span class="p">.</span><span class="n">timeout</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">timeout</span><span class="p">}</span><span class="n">s</span> <span class="s">&quot;$@&quot;</span>
</span><span class='line'><span class="nl">FAIL:</span> <span class="n">path</span>
</span><span class='line'><span class="n">timed</span> <span class="n">out</span> <span class="n">in</span> <span class="n">gotest</span>
</span><span class='line'>
</span><span class='line'><span class="p">...</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="n">runtest</span> <span class="n">completed</span> <span class="n">at</span> <span class="n">Fri</span> <span class="n">Jul</span> <span class="mi">12</span> <span class="mi">18</span><span class="o">:</span><span class="mi">09</span><span class="o">:</span><span class="mo">07</span> <span class="n">UTC</span> <span class="mi">2013</span>
</span></code></pre></td></tr></table></div></figure>


<p>That&rsquo;s certainly even more interesting. In case you haven&rsquo;t noticed, it&rsquo;s the same assertion that caused the failures in gccgo test suite. Let us find the offending code, shall we?</p>

<figure class='code'><figcaption><span>libpthread/pthread/pt-create.c</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cm">/* Set the new thread&#39;s signal mask and set the pending signals to</span>
</span><span class='line'><span class="cm">     empty.  POSIX says: &quot;The signal mask shall be inherited from the</span>
</span><span class='line'><span class="cm">     creating thread.  The set of signals pending for the new thread</span>
</span><span class='line'><span class="cm">     shall be empty.&quot;  If the currnet thread is not a pthread then we</span>
</span><span class='line'><span class="cm">     just inherit the process&#39; sigmask.  */</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">__pthread_num_threads</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>    <span class="n">err</span> <span class="o">=</span> <span class="n">sigprocmask</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sigset</span><span class="p">);</span>
</span><span class='line'>  <span class="k">else</span>
</span><span class='line'>    <span class="n">err</span> <span class="o">=</span> <span class="n">__pthread_sigstate</span> <span class="p">(</span><span class="n">_pthread_self</span> <span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sigset</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>  <span class="n">assert_perror</span> <span class="p">(</span><span class="n">err</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>This seems to be the code that the logs point to. But no sign of the assertion. After discussing this issue with my peers in #hurd, I was told that the code I was looking for (the failing assertion), is getting inlined via <code>_pthread_self ()</code> and is actually located in <code>libpthread/sysdeps/mach/hurd/pt-sysdep.h</code>.</p>

<figure class='code'><figcaption><span>libpthread/sysdeps/mach/hurd/pt-sysdep.h</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="k">extern</span> <span class="n">__thread</span> <span class="k">struct</span> <span class="n">__pthread</span> <span class="o">*</span><span class="n">___pthread_self</span><span class="p">;</span>
</span><span class='line'><span class="cp">#define _pthread_self()                                            \</span>
</span><span class='line'><span class="cp"> ({                                                         \</span>
</span><span class='line'><span class="cp">   struct __pthread *thread;                                \</span>
</span><span class='line'><span class="cp">                                                            \</span>
</span><span class='line'><span class="cp">   assert (__pthread_threads);                              \</span>
</span><span class='line'><span class="cp">   thread = ___pthread_self;                                \</span>
</span><span class='line'><span class="cp">                                                            \</span>
</span><span class='line'><span class="cp">   assert (thread);                                         \</span>
</span><span class='line'><span class="cp">   assert (({ mach_port_t ktid = __mach_thread_self ();     \</span>
</span><span class='line'><span class="cp">                     int ok = thread-&gt;kernel_thread == ktid;       \</span>
</span><span class='line'><span class="cp">                     __mach_port_deallocate (__mach_task_self (), ktid);\</span>
</span><span class='line'><span class="cp">                     ok; }));                                      \</span>
</span><span class='line'><span class="cp">          thread;                                                  \</span>
</span><span class='line'><span class="cp">         })</span>
</span></code></pre></td></tr></table></div></figure>


<p>So this is what I was looking for. Further discussing it in the weekly IRC meeting, braunr provided me with some more clues:</p>

<blockquote><p>08:38:15 braunr> nlightnfotis: did i answer that ?<br/>
08:38:24 nlightnfotis> braunr: which one?<br/>
08:38:30 nlightnfotis> hello btw :)<br/>
08:38:33 braunr> the problems you&rsquo;re seeing are the pthread resources leaks i&rsquo;ve been trying to fix lately<br/>
08:38:58 braunr> they&rsquo;re not only leaks<br/>
08:39:08 braunr> creation and destruction are buggy <br/>
08:39:37 nlightnfotis> I have read so in <a href="http://www.gnu.org/software/hurd/libpthread.html.">http://www.gnu.org/software/hurd/libpthread.html.</a> I believe it&rsquo;s under Thread&rsquo;s Death right?<br/>
08:40:15 braunr> nlightnfotis: yes but it&rsquo;s buggy<br/>
08:40:22 braunr> and the description doesn&rsquo;t describe the bugs<br/>
08:41:02 nlightnfotis> so we will either have to find a temporary workaround, or better yet work on a fix, right?<br/>
08:41:12 braunr> nlightnfotis: i also told you the work around<br/>
08:41:16 braunr> nlightnfotis: create a thread pool</p></blockquote>

<h1>Work for next week</h1>

<p>This leaves us with next week&rsquo;s work, which is to hack in libpthread&rsquo;s code to attempt to create a thread pool, so that we avoid some of the issues that are present now with the current implementation of the Hurd libpthread code.</p>

<p>It was also suggested by Samuel Thibault (youpi) that I should run the libgo tests by hand and see if I get some more clues, like stack traces. It sounds like a good idea to me, so that&rsquo;s something that I will look into too.</p>

    </div>
  </div>



  <footer>
    <hr>
    
    <div class="row-fluid">
      
      <div class="span6">
        <p class="meta">
        
        



  <a href="/blog/categories/gcc/"><span class="badge">gcc</span></a>

  <a href="/blog/categories/golang/"><span class="badge">golang</span></a>

  <a href="/blog/categories/gsoc/"><span class="badge">gsoc</span></a>




        </p>
      </div>
      
      <div class="span6 social-sharing">
        <div class="sharing">
  <div class="addthis_toolbox addthis_default_style ">
  
  
  <a class="addthis_button_tweet"></a>
  
  
  <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>

      </div>
      
      
    </div>
    
    <div class="row-fluid">
      <div class="span12">
        <p class="meta">
          
            <a class="basic-alignment left" href="/blog/2013/07/15/gsoc-week-4-report/" title="Previous Post: GSOC: Week 4 report">&laquo; GSOC: Week 4 report</a>
          
          
            <a class="basic-alignment right" href="/blog/2013/07/31/gsoc-week-6-report/" title="Next Post: GSOC: Week 6 report">GSOC: Week 6 report &raquo;</a>
          
        </p>
      </div>
    </div>
  </footer>
</article>

</div>



        </div>
      </div>
      <div class="row-fluid">
        <footer class="footer-page" role="contentinfo">
          <p>
  Copyright &copy; 2013 - Fotis Koutoulakis -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span> - Theme by <a href="http://alexgaribay.com">Alex Garibay</a>
</p>


        </footer>
      </div>
    </div>
  </div>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
