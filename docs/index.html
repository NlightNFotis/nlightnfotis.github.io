<!DOCTYPE html>
<html lang="en-GB">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  
  
  <title>Lambda reflections</title>
  <meta name="description" content="Functional Programming, Proofs, Bioinformatics and more.">
  

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://nlightnfotis.github.io/">
  
  
  <link rel="alternate" type="application/rss+xml" title="Lambda reflections" href="https://nlightnfotis.github.io/feed.xml">

  

  
  <meta property="og:title" content="Lambda reflections">
  <meta property="og:site_name" content="Lambda reflections">
  <meta property="og:url" content="https://nlightnfotis.github.io/">
  <meta property="og:description" content="Functional Programming, Proofs, Bioinformatics and more.">
  
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="NlightNFotis">
  <meta name="twitter:title" content="Lambda reflections">
  <meta name="twitter:description" content="Functional Programming, Proofs, Bioinformatics and more.">
  
    <meta name="twitter:creator" content="NlightNFotis">
  
  

  <link rel="dns-prefetch" href="https://fonts.gstatic.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Bitter:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet">

  

</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Lambda reflections</a>

    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/">About</a>
      
        
        <a class="page-link" href="/archives/">Archives</a>
      
        
        <a class="page-link" href="https://github.com/NlightNFotis">GitHub</a>
      
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="home">

  

  

  <ul class="post-list">
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            
              <a class="post-link" href="/2023/12/16/how-to-use-option-result/">How to Think About And Use the Option And Result Types</a>
            
          </h1>

          <p class="post-meta">
            Dez 16, 2023
            
              

 •
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/types/">types</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/rust/">rust</a>,
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/go/">go</a>,
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/c/">c++</a>,
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/haskell/">haskell</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  


            
            
          </p>
        </header>

        <div class="post-content">
          <p>This post is written with an aim to provide some clarity as to the purpose and
usage of the (evermore present) types <code class="language-plaintext highlighter-rouge">Option</code> and <code class="language-plaintext highlighter-rouge">Result</code> in various programming
languages.</p>

<hr />

<h2>The Beginning: the <code class="language-plaintext highlighter-rouge">bool</code> type</h2>

<p>We’re all used to using the <code class="language-plaintext highlighter-rouge">bool</code> type: its value set has arity <code class="language-plaintext highlighter-rouge">2</code>, basically
admitting two values:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">true</code>, and</li>
  <li><code class="language-plaintext highlighter-rouge">false</code>.</li>
</ul>

<p>This means that we can use it as a return type for a function to discriminate
between two outcomes from the function’s execution. Thus, it ties well with
predicates (functions answering a decision problem, e.g. <code class="language-plaintext highlighter-rouge">isDiscountValid</code>
or <code class="language-plaintext highlighter-rouge">any?</code>) and, more broadly, functions that want to indicate a <em>successful</em> outcome
or a <em>failure</em> outcome after their execution has finished.</p>

<p>The return of a <code class="language-plaintext highlighter-rouge">bool</code>-typed value allows these functions to have great synergy
with conditional statements/expressions, directly plugging into the <em>antecedent</em>
(condition) part of a conditional statement. Undoubtedly, you’ve come across
something like this (in C pseudo-syntax):</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">bool</span> <span class="nf">do_something</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// --snip--</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">something_went_wrong</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// signal failure</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// all went right in the main path</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// --snip---</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">do_something</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Operation was successful!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// perform some logging, or error recover here...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>This… works. But it’s a fairly rudimentary mechanism, with a significant limitation:
<em>what happens if we want to pass along some information in either case</em>?</p>

<p>This is a thought that has crossed many a programmer’s mind, and different languages
have provided different solutions to this problem, depending on whether the language
allows for <strong>one</strong> or <strong>more</strong> return values. Solutions fall within the following
general criteria:</p>

<ul>
  <li>Return a value if successful and <code class="language-plaintext highlighter-rouge">null</code>/<code class="language-plaintext highlighter-rouge">nil</code>/<code class="language-plaintext highlighter-rouge">None</code> otherwise.</li>
  <li>Nest the <code class="language-plaintext highlighter-rouge">bool</code> and the <code class="language-plaintext highlighter-rouge">value</code> in a <code class="language-plaintext highlighter-rouge">struct</code>/<code class="language-plaintext highlighter-rouge">class</code> and return that.</li>
  <li>Return a single <code class="language-plaintext highlighter-rouge">bool</code> value and extra values in <em>out-parameters</em>.</li>
  <li>Allow the return of <code class="language-plaintext highlighter-rouge">tuple</code>s containing the values.</li>
  <li><code class="language-plaintext highlighter-rouge">Option</code>/<code class="language-plaintext highlighter-rouge">Result</code>/<code class="language-plaintext highlighter-rouge">Either</code>.</li>
</ul>

<p>Let’s have a quick look at some examples. For each of the below examples, imagine
that our use case is the following:</p>

<blockquote>
  <p>We have a function which searches a rich document (think like a Word document)
for a particular search text.</p>
</blockquote>

<p>This is also called a “needle-in-haystack search”.</p>

<h3>Return a value if successful and <code class="language-plaintext highlighter-rouge">null</code> otherwise</h3>

<p>This was pretty much the default way people handled this situation in Algol-family
languages (C, C++, Java, etc.), especially in the past. It would look something
like the following (in Java-like pseudocode):</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Document</span> <span class="o">{</span>
    <span class="c1">// --snip--</span>

    <span class="kd">class</span> <span class="nc">SearchResult</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">column</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">line</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nc">SearchResult</span> <span class="nf">searchText</span><span class="o">(</span><span class="nc">String</span> <span class="n">needle</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// --snip --</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">found</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nf">SearchResult</span><span class="o">(</span><span class="n">column</span><span class="o">,</span> <span class="n">found</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The approach was fairly similar in C and C++, where instead of <code class="language-plaintext highlighter-rouge">null</code> someone
might see <code class="language-plaintext highlighter-rouge">return NULL;</code> or the more modern <code class="language-plaintext highlighter-rouge">return nullptr;</code> in the case of C++.</p>

<p>This approach came with a major, <strong><em>major</em></strong> flaw, one that has even been given
its own nickname across the industry, by its own creator (Sir Tony Hoare) nonetheless:
<a href="https://www.infoq.com/presentations/Null-References-The-Billion-Dollar-Mistake-Tony-Hoare/">the billion-dollar mistake</a>.</p>

<p>The problem is that the return value is usually then perused in a way that gets
dereferenced (either directly, through a pointer, like in C and C++ or indirectly
through objects in Java/C#, etc), causing the program to crash with either a friendly
error message or <s> an occult incantation out of Saruman's grimoire</s> a less descriptive
error message, depending on how well-behaved the language runtime you’re using is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// In Java

Exception in thread "main" java.lang.NullPointerException
    at Printer.printString(Printer.java:13)
    at Printer.print(Printer.java:9)
    at Printer.main(Printer.java:19)

// In C/C++

[1]    93157 segmentation fault  ./a.out
</code></pre></div></div>

<p>The computer <strong>really</strong> doesn’t like it when you force it to go to address <code class="language-plaintext highlighter-rouge">0x00</code>,
you see. But…</p>

<h3>Nest the value and the <code class="language-plaintext highlighter-rouge">bool</code> in a <code class="language-plaintext highlighter-rouge">class</code> and return that</h3>

<p>Seeing as we’re very sensitive to the computer’s plight (and our own inconvenience
and embarrassment), we might as well try to find a different way: one that, at least,
doesn’t result in a crash.</p>

<p>One way to solve the above problem, especially in the past, would be to wrap both
the <code class="language-plaintext highlighter-rouge">bool</code> and the return value (in the successful case) in a single compound type
(a <code class="language-plaintext highlighter-rouge">class</code>), and return values of that type. It would look something like the following.</p>

<p>Assume that our string-search function has been programmed to return a <code class="language-plaintext highlighter-rouge">SearchResult</code>
type of the following form:</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="nc">SearchResult</span> <span class="p">{</span>
    <span class="kt">bool</span> <span class="n">success</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">column</span><span class="p">;</span>     <span class="c1">// present only if text was found</span>
    <span class="kt">int</span> <span class="n">line</span><span class="p">;</span>       <span class="c1">// ditto</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Objects of that type would use the <code class="language-plaintext highlighter-rouge">success</code> sub-component as a discriminating
value, indicating on whether the search yielded a successful match or not. The
rest of the sub-components (<code class="language-plaintext highlighter-rouge">column</code> and <code class="language-plaintext highlighter-rouge">line</code>) would have well-defined values
if the <code class="language-plaintext highlighter-rouge">success</code> is <code class="language-plaintext highlighter-rouge">true</code>, and undefined otherwise.</p>

<p>Thus, our function might look something like this:</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">SearchResult</span> <span class="nf">search_text</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">subtext</span><span class="p">,</span> <span class="k">const</span> <span class="n">Document</span><span class="o">&amp;</span> <span class="n">doc</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// --snip--</span>
    
    <span class="k">if</span><span class="p">(</span><span class="n">found</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span><span class="nb">true</span><span class="p">,</span> <span class="n">column_no</span><span class="p">,</span> <span class="n">line_no</span><span class="p">};</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span><span class="nb">false</span><span class="p">,</span> <span class="n">random</span><span class="p">(),</span> <span class="n">random</span><span class="p">()};</span> <span class="c1">// random to simulate undefined value</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<p>Now, if we wanted to use our <code class="language-plaintext highlighter-rouge">search_text</code> function, being the responsible programmers
we are, we would first check the <code class="language-plaintext highlighter-rouge">success</code> field:</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">perform_action</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// --snip--</span>

    <span class="k">const</span> <span class="k">auto</span> <span class="n">result</span> <span class="o">=</span> <span class="n">search_text</span><span class="p">(</span><span class="s">"the jabberwocky"</span><span class="p">,</span> <span class="n">alice_in_wonderland</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">success</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Found at line %d and column %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">line</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">column</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// !result.success </span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Unable to find given text within the document."</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>This is definitely a solution, and one that was adopted in various codebases I’ve
seen in the past, but it also suffers from a flaw, albeit a less severe one this
time: the pollution of the codebase with many similar but <em>oh-so-slightly-different</em>
types which served only as “rich-return-typed objects”.</p>

<p>This has the side-effect of an increase to the cognitive load of the programmer,
which makes the experience of programming in that codebase a bit worse than it
needs to be: the editors and other tools might help, but you still need to mentally
keep track of which function returns what, and have some special handling around
any of those.</p>

<h3>Out-parameters</h3>

<p>This one is a variation of the two themes above, falling somewhat in the middle:
it still signals success and makes it harder (kinda…) to crash the application.
This time around, our code would look similar to this:</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Our SearchResult object</span>
<span class="k">struct</span> <span class="nc">SearchResult</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">column</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">line</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// And the search function</span>
<span class="kt">bool</span> <span class="nf">search_text</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">needle</span><span class="p">,</span> <span class="k">const</span> <span class="n">Document</span><span class="o">&amp;</span> <span class="n">haystack</span><span class="p">,</span> <span class="n">SearchResult</span><span class="o">&amp;</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// --snip--</span>
    
    <span class="k">if</span><span class="p">(</span><span class="n">found</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">SearchResult</span><span class="p">{</span><span class="n">column_no</span><span class="p">,</span> <span class="n">line_no</span><span class="p">};</span> 
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// With our usage looking like this:</span>

<span class="kt">void</span> <span class="nf">perform_action</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// --snip--</span>

    <span class="k">auto</span> <span class="n">result</span> <span class="o">=</span> <span class="n">SearchResult</span><span class="p">{};</span> 

    <span class="k">const</span> <span class="k">auto</span> <span class="n">found</span> <span class="o">=</span> <span class="n">search_text</span><span class="p">(</span><span class="s">"the jabberwocky"</span><span class="p">,</span> <span class="n">alice_in_wonderland</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">result</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">found</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Found at line %d and column %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">line</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">column</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// !found </span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"Unable to find given text within the document."</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>This, again, also works. It’s a fine solution for many people (given how widespread
out-parameters are) and enjoys a good performance profile because of the pointers/references,
but I personally heavily dislike it from an aesthetics/philosophical standpoint:</p>

<blockquote>
  <p>A function should only ever return its return value and nothing else.</p>
</blockquote>

<p>What can I say? I’m a functional-programming kind of guy.</p>

<h3>Allow the return of a tuple containing the values</h3>

<p>If we use the above quote as an axiom for our programming system, we kind of
find ourselves in a bind: we both want to return a <code class="language-plaintext highlighter-rouge">bool</code>, and a secondary value
based on the value of the <code class="language-plaintext highlighter-rouge">bool</code> itself.</p>

<p>Or are we?</p>

<p>For programming languages that only allow one return value, we can look into
packing our <code class="language-plaintext highlighter-rouge">bool</code> and the auxiliary value into a <code class="language-plaintext highlighter-rouge">pair</code> or an <code class="language-plaintext highlighter-rouge">n-tuple</code> (it’s
arity-based generalisation).</p>

<p>This used to be harder, but nowadays most programming languages offer more mathematical
primitives in their standard libraries.</p>

<p>For example, adapting our example above to something like Kotlin:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fun</span> <span class="nf">searchText</span><span class="p">(</span><span class="n">needle</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span> <span class="n">haystack</span><span class="p">:</span> <span class="nc">Document</span><span class="p">):</span> <span class="nc">Pair</span><span class="p">&lt;</span><span class="nc">Boolean</span><span class="p">,</span> <span class="nc">SearchResult</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="c1">// --snip--</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">found</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nc">Pair</span><span class="p">(</span><span class="k">true</span><span class="p">,</span> <span class="nc">SearchResult</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">line</span><span class="p">))</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nc">Pair</span><span class="p">(</span><span class="k">false</span><span class="p">,</span> <span class="nc">SearchResult</span><span class="p">())</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>And for our usage, this time around:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">result</span> <span class="p">=</span> <span class="nf">searchText</span><span class="p">(</span><span class="s">"The Queen of Hearts"</span><span class="p">,</span> <span class="n">aliceInWonderland</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">first</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"Found The Queen of Hearts at ${result.second}"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>There are also some languages that allow you to return multiple values in their
base syntax (internally, they might do packing/unpacking automatically to achieve
an effect very similar to the above). Of these, perhaps Go is the most famous one,
using this as an idiom for error handling:</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="s">"errors"</span>

<span class="k">func</span> <span class="n">example_function</span><span class="p">(</span><span class="n">arg</span> <span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="m">42</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">-</span><span class="m">1</span><span class="p">,</span> <span class="n">errors</span><span class="o">.</span><span class="n">New</span><span class="p">(</span><span class="s">"can't work with 42"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">arg</span> <span class="o">+</span> <span class="m">3</span><span class="p">,</span> <span class="no">nil</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">result</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">example_function</span><span class="p">(</span><span class="m">42</span><span class="p">);</span>
    <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
        <span class="c">// Log or do some error handling here</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2><code class="language-plaintext highlighter-rouge">Option</code>/<code class="language-plaintext highlighter-rouge">Result</code>/<code class="language-plaintext highlighter-rouge">Either</code></h2>

<p>Wow. What a trip. Let’s have a quick recap so that we see where we are:</p>

<ul>
  <li>We started with a function doing something, and returning <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code> to
show whether it succeeded or not.</li>
  <li>Our requirements evolved to now also need some extra information <em>in addition</em>
to the above <code class="language-plaintext highlighter-rouge">true</code>/<code class="language-plaintext highlighter-rouge">false</code> values.</li>
  <li>We explored a number of different ways to satisfy that new requirement.</li>
</ul>

<p>But all of them were a bit lacking, in various different ways:</p>

<ul>
  <li>They… allowed us to crash, either by accidental mistake or misuse of their
interface.</li>
  <li>They didn’t provide enough context to the compiler to assist us with development
(and to provide guardrails <em>against</em> misuse), using pattern matching for instance.</li>
  <li>They depended on the creation of other context-sensitive types, with non-uniform
forms.</li>
  <li>They fallback to using types (e.g. <code class="language-plaintext highlighter-rouge">Pair</code> or <code class="language-plaintext highlighter-rouge">Triple</code>) that lack specificity
to guide our expectations and intuition to a specific context.</li>
</ul>

<p>All of the above are solved by the <code class="language-plaintext highlighter-rouge">Option</code> and <code class="language-plaintext highlighter-rouge">Result</code> type (and its more general
dual in Haskell, <code class="language-plaintext highlighter-rouge">Either</code>).</p>

<p>All of them are what’s known in Programming Language Theory as <em>Sum Types</em> (sometimes
called <em>Discriminated Unions</em>), due to the fact that the value set of the Compound
type is the <em>sum</em> of the <em>cardinality</em> of the <em>sets</em> of the <em>atomic types</em> (called
constructors) that comprise them.</p>

<p>The type definitions look like these (in an ML-inspired pseudosyntax):</p>

<div class="language-fsharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="nc">Option</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;</span> <span class="p">=</span>
  <span class="p">|</span> <span class="nc">Some</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;</span>
  <span class="p">|</span> <span class="nc">None</span>

<span class="k">type</span> <span class="nc">Result</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">,</span> <span class="nc">E</span><span class="p">&gt;</span> <span class="p">=</span>
  <span class="p">|</span> <span class="nc">Ok</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;</span>
  <span class="p">|</span> <span class="nc">Err</span><span class="p">&lt;</span><span class="nc">E</span><span class="p">&gt;</span>

<span class="k">type</span> <span class="nc">Either</span><span class="p">&lt;</span><span class="nc">L</span><span class="p">,</span> <span class="nc">R</span><span class="p">&gt;</span> <span class="p">=</span>
  <span class="p">|</span> <span class="nc">Left</span><span class="p">&lt;</span><span class="nc">L</span><span class="p">&gt;</span>
  <span class="p">|</span> <span class="nc">Right</span><span class="p">&lt;</span><span class="nc">R</span><span class="p">&gt;</span>
</code></pre></div></div>

<p>All of the above are generic types, admitting generic parameters (the <code class="language-plaintext highlighter-rouge">T</code>, <code class="language-plaintext highlighter-rouge">E</code>s,
etc.).</p>

<p>(At this point, it’s worth observing that <code class="language-plaintext highlighter-rouge">Either</code> is isomorphic to <code class="language-plaintext highlighter-rouge">Result</code>, so
from now on onwards, what we mention for <code class="language-plaintext highlighter-rouge">Result</code> will apply to <code class="language-plaintext highlighter-rouge">Either</code> as well,
without the need to explicitly say so).</p>

<hr />

<p>An interesting pattern appears if we also provide a type definition for a <code class="language-plaintext highlighter-rouge">Boolean</code>
type in the same pseudo syntax:</p>

<div class="language-fsharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="nc">Boolean</span> <span class="p">=</span>
  <span class="p">|</span> <span class="nc">True</span>
  <span class="p">|</span> <span class="nc">False</span>
</code></pre></div></div>

<p>If we also remove the generic parameters from the above type definitions (just
for illustration purposes) and lay them all next to each other, we’re going to
observe that their value sets their definitions are identical (with only different
<em>names</em> for the various constructors):</p>

<div class="language-fsharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="nc">Boolean</span> <span class="p">=</span>
  <span class="p">|</span> <span class="nc">True</span>
  <span class="p">|</span> <span class="nc">False</span>

<span class="k">type</span> <span class="nc">Option</span> <span class="p">=</span>
  <span class="p">|</span> <span class="nc">Some</span>
  <span class="p">|</span> <span class="nc">None</span>

<span class="k">type</span> <span class="nc">Result</span> <span class="p">=</span>
  <span class="p">|</span> <span class="nc">Ok</span>
  <span class="p">|</span> <span class="nc">Err</span>
</code></pre></div></div>

<p>Wow! This near-identical (isomorphic) form is also a hint that their <em>semantics</em>
are also very similar. Let’s try to put the generic parameters (but as comment
for a clarity) and see how we do:</p>

<div class="language-fsharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="nc">Boolean</span> <span class="p">=</span>
  <span class="p">|</span> <span class="nc">True</span>
  <span class="p">|</span> <span class="nc">False</span>

<span class="k">type</span> <span class="nc">Option</span> <span class="p">=</span>
  <span class="p">|</span> <span class="nc">Some</span> <span class="o">--</span> <span class="k">with</span> <span class="n">extra</span> <span class="n">information</span>
  <span class="p">|</span> <span class="nc">None</span>

<span class="k">type</span> <span class="nc">Result</span> <span class="p">=</span>
  <span class="p">|</span> <span class="nc">Ok</span>  <span class="o">--</span> <span class="k">with</span> <span class="n">extra</span> <span class="n">information</span>
  <span class="p">|</span> <span class="nc">Err</span> <span class="o">--</span> <span class="k">with</span> <span class="n">extra</span> <span class="n">information</span>
</code></pre></div></div>

<p>A clear pattern now emerges! All of these signal the same sort of binary outcome,
with the capability of also carrying extra information.</p>

<p>Nice! The keen eyed amongst you will have noticed that this insight has now solved
our original problem in a very clean way, and has at the same time provided a very
clear usage guideline:</p>

<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">Boolean</code> whenever you only need to discriminate between two outcomes.</li>
  <li>Use <code class="language-plaintext highlighter-rouge">Option</code> whenever you want to do the above, but also want to carry extra
information around in the <code class="language-plaintext highlighter-rouge">True</code> case.</li>
  <li>Use <code class="language-plaintext highlighter-rouge">Result</code> whenever you want to discriminate between two outcomes but also
want to carry extra information around in both of these cases.</li>
</ul>

<p>Let’s have a look at some examples in Rust to see how we would choose which one
to use in practice. Let’s have a look at 3 different cases:</p>

<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="n">Person</span> <span class="p">{</span>
    <span class="n">age</span><span class="p">:</span> <span class="nb">u8</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">impl</span> <span class="n">Person</span> <span class="p">{</span>
    <span class="c1">// A Person can either drink (is of legal age) or not.</span>
    <span class="c1">// True or false. No other information needed.</span>
    <span class="k">fn</span> <span class="nf">can_drink</span><span class="p">()</span> <span class="k">-&gt;</span> <span class="nb">bool</span> <span class="p">{</span>
        <span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">18</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>In the above case we see an example of a <em>predicate</em> (a function returning <code class="language-plaintext highlighter-rouge">true</code>/<code class="language-plaintext highlighter-rouge">false</code>,
in effect solving a decision problem). Boolean values work very well for predicates:
we only want the first order value - it’s either <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code>, but we don’t
care why in either case.</p>

<p>Let’s now have a look at a case where we might care about extra information in
addition to the first-order value: Let’s assume we’re searching for a value in a
vector and want to know its index in it:</p>

<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fn</span> <span class="nf">search</span><span class="p">(</span><span class="n">needle</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">String</span><span class="p">,</span> <span class="n">haystack</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">Option</span><span class="o">&lt;</span><span class="nb">usize</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="c1">// Return `Some(index)` if value is present `None` otherwise</span>
    <span class="n">haystack</span><span class="nf">.iter</span><span class="p">()</span><span class="nf">.position</span><span class="p">(|</span><span class="n">x</span><span class="p">|</span> <span class="n">x</span> <span class="o">==</span> <span class="n">needle</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">let</span> <span class="n">fruit</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[</span>
        <span class="s">"banana"</span><span class="nf">.to_string</span><span class="p">(),</span>
        <span class="s">"mango"</span><span class="nf">.to_string</span><span class="p">(),</span>
        <span class="s">"apple"</span><span class="nf">.to_string</span><span class="p">()</span>
    <span class="p">];</span>
    <span class="k">let</span> <span class="n">res</span> <span class="o">=</span> <span class="nf">search</span><span class="p">(</span><span class="o">&amp;</span><span class="s">"apple"</span><span class="nf">.to_string</span><span class="p">(),</span> <span class="o">&amp;</span><span class="n">fruit</span><span class="p">);</span>
    <span class="nd">assert_eq!</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="nf">Some</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></div>

<p>In this case, our search function will search for the string <code class="language-plaintext highlighter-rouge">needle</code> inside
the collection <code class="language-plaintext highlighter-rouge">haystack</code>. If it succeeds (the <code class="language-plaintext highlighter-rouge">true</code> case), it’s going to return
us a value that signals that it succeeded, along with the extra information we
asked for (the index in our case). This is the <code class="language-plaintext highlighter-rouge">Some(T)</code> constructor that we saw
above in the type definitions. If it fails, it will instead return <code class="language-plaintext highlighter-rouge">None</code> (the
<code class="language-plaintext highlighter-rouge">false</code> equivalent).</p>

<p>This is a great example of the typical use-case for <code class="language-plaintext highlighter-rouge">Option</code>: we use it in contexts
where we want to attach auxiliary data in the successful case, but where if we fail,
we don’t care enough to know more about the failure case - only that it happened.</p>

<p>That gap is being filled by <code class="language-plaintext highlighter-rouge">Result</code> - it’s like <code class="language-plaintext highlighter-rouge">Option</code> semantically, but it allows
us to also carry around extra data in the case <code class="language-plaintext highlighter-rouge">false</code> case. This is useful in that
it allows us to carry around diagnostic information in the failure case, to allow
with error reporting and recovery.</p>

<p>An example of this need being satisfied would be the following function:</p>

<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">fn</span> <span class="nf">read_to_string</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="o">&amp;</span><span class="nb">str</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">Result</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span> <span class="nn">io</span><span class="p">::</span><span class="n">Error</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">let</span> <span class="k">mut</span> <span class="n">file</span> <span class="o">=</span> <span class="k">match</span> <span class="nn">File</span><span class="p">::</span><span class="nf">open</span><span class="p">(</span><span class="o">&amp;</span><span class="n">filename</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">Ok</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">=&gt;</span> <span class="n">f</span><span class="p">,</span>
        <span class="nf">Err</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">=&gt;</span> <span class="k">return</span> <span class="nf">Err</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
    <span class="p">};</span>

    <span class="k">let</span> <span class="k">mut</span> <span class="n">text</span> <span class="o">=</span> <span class="nn">String</span><span class="p">::</span><span class="nf">new</span><span class="p">();</span>
    <span class="k">match</span> <span class="n">file</span><span class="nf">.read_to_string</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="n">text</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">Ok</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">=&gt;</span> <span class="nf">Ok</span><span class="p">(</span><span class="n">text</span><span class="p">),</span>
        <span class="nf">Err</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">=&gt;</span> <span class="nf">Err</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Here our <code class="language-plaintext highlighter-rouge">read_to_string</code> function is doing two things:</p>

<ol>
  <li>Open a file, and</li>
  <li>Read its contents into a string buffer.</li>
</ol>

<p>Any of these two operations can fail. If we only had a <code class="language-plaintext highlighter-rouge">bool</code> value as the return
value, we could signal that a failure happened by returning <code class="language-plaintext highlighter-rouge">false</code>, but we would
be at a loss as to <em>what</em> has actually failed.</p>

<p>In this case, our <code class="language-plaintext highlighter-rouge">Result</code> type allows us to do the following:</p>

<ul>
  <li>If everything worked fine, return the <code class="language-plaintext highlighter-rouge">Ok()</code> constructor with an appropriate
value attached (the string buffer in our case, after completion).</li>
  <li>If there was an error, either at file opening or reading, returning an <code class="language-plaintext highlighter-rouge">Err()</code>
constructor, with an appropriate error message attached.</li>
</ul>

<h2>Conclusion</h2>

<p>To wrap everything up, here’s my usage heuristic for the above types:</p>

<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">bool</code> for simple predicates.</li>
  <li>Use <code class="language-plaintext highlighter-rouge">Option&lt;T&gt;</code> when extra data needs to be carried in the success case (for instance
when searching for values in a collection)</li>
  <li>Use <code class="language-plaintext highlighter-rouge">Result&lt;T,E&gt;</code> when extra data needs to be carried around in the success and failure
case (say, if you’re reading something from the network, and you want to return
the data in the success case or an appropriate error message in the failure case).</li>
</ul>

        </div>
        
      </li>
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            
              <a class="post-link" href="/2023/02/12/yearly-goals-2023/">Yearly Goals: 2023</a>
            
          </h1>

          <p class="post-meta">
            Feb 12, 2023
            
              

 •
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/yearly-goals/">yearly-goals</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  


            
            
          </p>
        </header>

        <div class="post-content">
          <h2>Context</h2>

<p>In a <a href="/2023/01/14/year-in-review-2022/">previous post</a> I promised a post
on my yearly goals, along with the rationale behind them.</p>

<p>The reason I have explicitly outlined goals every year is that they serve in the same
capacity that <a href="https://en.wikipedia.org/wiki/OKR">OKRs</a> serve in a corporate setting, that
is, to provide a northern star during the time period they demarcate along with some
quantifiable metrics that can provide a final outcome analysis.</p>

<p>I started setting explicit yearly goals in 2020, and the results have been great for me,
in the sense that while I don’t always reach my goals, the documentation itself serves
as a clarification and reinforcing mechanism for my thinking process and my short-term
and long-term goal-setting.</p>

<p>So, without any further ado, let’s move on to the…</p>

<h2>Yearly Goals: 2023</h2>

<p><strong>Main Themes</strong>:</p>

<p>I have organised my developmental goals for 2023 around three main themes:</p>

<ul>
  <li>Improvement of financial stability</li>
  <li>Improvement of mathematical maturity</li>
  <li>Improvement of musical capacity</li>
</ul>

<p>These are the main development themes - I do maintain some side goals in my plan,
but I try to build around a certain number of development themes every year. Main
themes within this contexts means that the majority of my efforts for the year is
going to be spent in developing across one of these main themes.</p>

<p>Let’s see what I aim for in each of these development themes.</p>

<h3>Financial Stability</h3>

<p>Last year was a very exciting year for me personally, with the biggest change being
my purchase of a new appartment in Oxford. I have <a href="/2023/01/14/year-in-review-2022/">gone through all of the benefits</a>
that this move afforded me in a previous post, but this move also came packaged with
significant financial strain in the first few months after the purchase. It also didn’t
help that most of my financial resources went into the purchase itself (and associated
costs like conveyancing, etc), so that meant that I found myself earlier last year
with significant liquidity constraints.</p>

<p>These liquidity constraints have significantly eased throughout 2022, as most of my
furniture has now been paid off and cash flows are getting freed to serve other purposes,
which allows me to focus on the following two subgoals for this year:</p>

<ul>
  <li>Enhance my financial safety net, and</li>
  <li>Support long-term financial outcomes.</li>
</ul>

<p>Both of these two subgoals are measured against specific amounts levels that my
L1 (liquid), L2 (support + growth) and L3 (long term growth + illiquid) positions
should have achieved by the end of the year.</p>

<p>The reasons for these two subgoals should be fairly obvious:</p>

<ul>
  <li>A robust financial safety net would allow me to deeply focus on my other activities
without financial constraints occupying mental space (or at least, significant amounts
of it), and</li>
  <li>
    <p>I recently read a book on retirement investing, which had some benchmark figures of where
retirement accounts should be by certain age groups and what percentage of your income
you should be saving for retirement at certain age categories, and shockingly, I found
out that I am quite a long way away from these benchmarks in my current capacity.</p>

    <p>Long term investing is the kind of thing where small changes today can compound into massive
differences between outcomes in the future, so for now I have decided to allocate an additional
3%+ per month of my total income towards enhancing my retirement accounts and increase the
chance that future outcomes are more aligned with what the experts suggest is a viable
retirement strategy.</p>

    <p>(This allocation strategy is just for this year, and I intend to revisit this decision at
the end of this year to checkout how it has performed and whether it does indeed help with
getting closer to the outcomes I am looking for.)</p>
  </li>
</ul>

<h3>Mathematical Maturity</h3>

<p>Coming out of university I believe I had attained a very robust background in Discrete
Mathematics, which at the time aimed to serve very well with my then chosen subdomains
in Computer Science: Compilers, Languages and Verification.</p>

<p>However, I didn’t practice (both at university and afterwards) my maths skills in other
subdomains, to the point where I have found some my skills there atrophied.</p>

<p>I had made some efforts during 2020 and 2021 to repair my skills there, but as I expand
across multiple domains, I have found that an enhanced mathematical capacity will be a
significant asset for the rest of my life (and would support my future forays into
data science, quant finance and synthetic biology a lot better) - with the added bonus
of building competence and confidence that would allow me to be fearless against
any mathematical problem that I face on a going forward basis.</p>

<p>To that end, I have decided to dedicate a good chunk of my time this year to improve
my mathematical maturity. I have some study guides that I am following, the most significant
of which are:</p>

<ul>
  <li><a href="https://www.neilwithdata.com/mathematics-self-learner">Mathematics for the adventurous self-learner</a>, and</li>
  <li><a href="https://github.com/ossu/math">OSSU Math</a></li>
</ul>

<p>I do not intend to follow these too closely for now, as I want to have my exploration be
curiosity driven - but certainly having some study guides helps with having guidance
if and when I need it.</p>

<h3>Musical Capacity</h3>

<p>I hold no secret of my musical aspirations (I will become the male equivalent of Ava Max… eventually :) ).</p>

<p>I have been moving slower than I would like to on this front, so this year I have set up
a target hours-spent goal of about 250 hours spent developing across anything that would
enhance my skills in this area. This includes but is not limited to:</p>

<ul>
  <li>Dancing,</li>
  <li>Songwriting,</li>
  <li>Music Theory,</li>
  <li>Piano,</li>
  <li>Guitar,</li>
  <li>Singing.</li>
</ul>

<p>Regardless of the time spent building across these, I still don’t expect that my skills in
this domain will be deployable in any meaningful capacity, but I do expect that a certain
number of hours in which I deliberately practice should help in slowly chiseling a core set
of skills that I can depend on at a later date.</p>

<h2>Last thoughts</h2>

<p>A pretty tall order this year as well with regards to yearly goals, but I am confident that
these should be pretty attainable.</p>

<p>All of these are iteration based, so they just depend on my habits, which are pretty streamlined
at this point. The goals have been crafted in such a way as to be controlled by me and appear
resilient to uncertainty, as they do not depend on external sources or any massive action nor
are there any clearly identifiable risks on the horizon across any of these development themes
that would threaten my yearly desired outcomes.</p>

<p>Wishing myself and others a beautiful and productive 2023, with all your goals achieved,
leading us all into a brighter future.</p>

        </div>
        
      </li>
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            
              <a class="post-link" href="/2023/01/14/year-in-review-2022/">A Year In Review: 2022</a>
            
          </h1>

          <p class="post-meta">
            Jan 14, 2023
            
              

 •
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/year-in-review/">year-in-review</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  


            
            
          </p>
        </header>

        <div class="post-content">
          <h2>Progress Review</h2>

<p>Another year has come to a close, and so this time I decided to try a new
experiment - I’ll author a public review of my year.</p>

<p>The yearly review is not a new concept for me (if you recall from hints in previous
posts, I’m hugely into quantified self and various metrics and reflection processes).
But a public one (sharing where I am in real time) is new.</p>

<p>The experimental side of it is based on the fact that by laying my progress bare,
I hope that I can connect with other people on a similar journey, or at the very
least provide a template for other people who may be inspired to set out on a similar
journey (I have been inspired by others in various subdomains in the past, and
hope to pay it forward this way).</p>

<p>I will run through this in the same way that I go about my usual yearly reviews, enlisting
various accomplishments into various buckets that I call <em>“progress subdomains”</em>,
which are various domains in which I want to broadly improve (and which align with
my long-term vision for myself).</p>

<p>I will also be providing some background as we go through the various buckets,
to help contextualise both the aims and the activities surrounding these buckets.</p>

<p><strong>Highlights</strong></p>

<ul>
  <li><strong>1409</strong> total self improvement hours, new yearly record</li>
  <li><a href="https://www.goodreads.com/user_challenges/31040356"><strong>78</strong> books read during the year</a>,
new yearly record</li>
  <li><strong>4</strong> new programming languages engaged with</li>
</ul>

<p><strong>What went well</strong></p>

<ul>
  <li>Significant progress in self-improvement capacity, afforded by the greater focus
allowed by living alone for the first time in a while in <code class="language-plaintext highlighter-rouge">o2.Flutter</code>.</li>
  <li>On the same note, managed to clock in <code class="language-plaintext highlighter-rouge">1409</code> hours of self improvement,
against <code class="language-plaintext highlighter-rouge">1290</code> hours in 2021, which was already a record year on its own.</li>
  <li>Significant time spent on improving CS skills, while also improving rapidly
across Biology/Chemistry.</li>
  <li>Uptake of musical capacity, spending significant time on practicing singing,
guitar, piano and learning music theory.</li>
  <li>Reinitiation of my dancing training - this time through <a href="https://www.steezy.co">Steezy</a></li>
  <li>Furnishing <code class="language-plaintext highlighter-rouge">o2.Flutter</code> is 95% complete.</li>
  <li>Improvements in financial posturing throughout the year.</li>
  <li>Delivered above expectations at work, setting expectations for promotions/salary
increases in 2023.</li>
  <li>Recommitted in Q1/22 to improve my Spanish knowledge, and managed to clock in
over 50 hours of study during the year.</li>
  <li>Improved processes for managing my time, including running my personal life
in terms of sprints.</li>
</ul>

<p><strong>What didn’t go well</strong></p>

<ul>
  <li>Acquisition of R&amp;G facility <code class="language-plaintext highlighter-rouge">o2.Flutter</code> had initially caused significant
financial strain, applying a lot of liquidity pressure in early 2022, and
acquiring significant debt load in attempt to rapidly furnish it.</li>
  <li>Financial markets turmoil materialised after the closing of the acquisition
of the R&amp;G facility, but this meant that while I was spared the brunt of the
market decline marking losses on my assets, I also didn’t go very far in terms
of net worth growth, as asset prices declined while I was committing more
money in the markets.</li>
  <li>Most of my acquantainces leaving Oxford during the 2020 pandemic meant that
I now find myself with a significantly diminished (in terms of size) social circle
in Oxford. This hasn’t presented itself as a major challenge yet, and some
measures have been taken to ameliorate any future risks here, but I’m mindful of it.</li>
  <li>I’m not a huge club person, but I appeared in one earlier this year, begrudgingly
brought by some newly acquired set of acquaintances. I was a <em>stick</em> - unable
to move at all. This was <em>unacceptable</em> for two reasons: 1) I spent 3 years doing
latin dancing very dilligently, and 2) I intend to become a pop singer in the
future and dancing is a huge part of stage presence.
    <ul>
      <li>(This was what prompted my getting into dancing again as highlighted in the
list above.)</li>
    </ul>
  </li>
</ul>

<h2>In Greater Detail</h2>

<h2>o2.Flutter</h2>

<p>In late 2021, I closed on a transaction to acquire a new appartment in Oxford,
to use as my new base of operation (work from home, practicing music, studying, etc).</p>

<p>Bases of operation are technically categorised as <em>Research &amp; Growth Facilities</em> by
me (because I’m a nerd, and because I like to mentally picture them as labs/facilities
for improvement rather than a place for being chillaxed and tardy), so this one has
been symbollically codenamed <code class="language-plaintext highlighter-rouge">o2.Flutter</code>. <code class="language-plaintext highlighter-rouge">o2</code> is a nod to this being the second place
in Oxford that I expect to spend quite some time in, and <code class="language-plaintext highlighter-rouge">Flutter</code> is symbolising
that this is going to allow me to fly higher. :)</p>

<p>After closing, I quickly flew to Greece for some administrative work there, which
meant that I moved in when I came back some time in early 2022.</p>

<p>This was easily one of the best moves I’ve done in my life thus far, for a variety
of reasons:</p>

<ul>
  <li>I’m a bit unusual (in lack of a better word) in a lot of ways, which means
that it made it harder for me to live with others in a houseshare.
    <ul>
      <li>This had become such a big issue for me, as I was in my late 20s and living
with students in houseshares, who… have a different lifestyle. This means
that living with them as a working professional, especially one working from
home is untenable, to the point where I had an internal deadline of solving
the housing problem before I hit my 30 year birthday or I would leave Oxford
(and potentially England) for good.</li>
    </ul>
  </li>
  <li>
    <p>The appartment is a new-built, with all the goodies these come with, and especially:
<em>soundproofing</em>. This means that I can practice my music without bothering anyone.</p>
  </li>
  <li>
    <p>I have a room dedicated to being the <em>home office</em>. This is a huge part of what I
want from my R&amp;G facilities going forward. It ended up being amazing in synergy
with the fact that both the company I work at and the industry at large are moving
towards a more permanent <em>Work From Home</em> regime.</p>
  </li>
  <li>
    <p>It’s also great in that compared to the work office, I can zone in and become focused
on a task at hand at a much more rapid pace, skyrocketing my productivity both
at work and at self-improvement endeavours, like reading for information.</p>
  </li>
  <li>It’s also great to have an enclosed space which I can shape up however I want,
and can apply my standards to. No more kitchen in a mess because someone else
cooked and couldn’t be arsed to clean up because he had to play some video games :)
    <ul>
      <li>This fact alone has contributed massively to my general lack of anger and
tranquility that I enjoy these days.</li>
    </ul>
  </li>
  <li>And, perhaps most importantly, the lack of distractions/commuting means that
I can spend unreal amounts of time engaging with self-improvement activities
(practicing instruments, reading books, practicing programming, working out
at home, etc), that is further compounding my general level of happiness/direction/fulfilment.</li>
</ul>

<p>Of course, buying a house, especially in Oxford, comes with a whole swath
of new challenges, including:</p>

<ul>
  <li>
    <p>There’s a significant financial outlay in the beginning. Not only for the property
itself, but paying conveyancers, mortgage arrangement fees, taxes, etc.</p>
  </li>
  <li>
    <p>There’s also the problem of furnishing the place. It’s expensive. It’s even
worse if you have to furnish a new (i.e. empty) house against the backdrop
of a 10-year high inflationary spike, and severely disrupted supply chains
(most of furniture ended up being delivered with a significant delay).</p>
  </li>
  <li>
    <p>To afford a place that’s close to my specification for an R&amp;G facility, I had
to buy somewhere at the edges of Oxford, which means that the few times when
I have to commute, commuting takes much longer now.</p>
  </li>
  <li>
    <p>It’s also generally much more expensive having a house - I’m now financially
responsible for everything here (all bills, potential damage or substitution of
devices, etc), which is something you don’t have to concern yourself with
as much when renting.</p>
  </li>
</ul>

<p>Overall, the biggest challenge is that owning the facility itself has increased
my outlay for housing costs by about 2x, but of course, for me personally, it
was worth it (and then some) if I take into account all of the new capacity
for self-improvement that it affords me.</p>

<h2>Intellectual Progress</h2>

<p>It’s hard to quantify my improvement in terms of intellectual prowess,
seeing as it doesn’t lend itself easily to any sort of quantification, at least
not one that is broad within different subdomains (I can’t say I became <code class="language-plaintext highlighter-rouge">x %</code>
better in Chemistry this year with accuracy).</p>

<p>But what I can do (and what I actually do) is measure what I call <em>mini-achievements</em>,
which are more or less what it sounds like: micro-checkpoints across the larger roadmap,
which show me that while I’m not there yet, I’m moving in the right direction. The
thinking behind this is that after accumulating a lot of those within a subdomain,
I should have enough obvious progress (say, if you’ve read a number of books in Chemistry,
in a focused and mindful way, over time your Chemistry knowledge is bound to accumulate).</p>

<h3>Programming/CS</h3>

<p>Let’s start with my primary subdomain of focus: <strong>Programming/CS</strong>. This is because
I spend a relatively large amount of time reading/practicing/improving my skills in
Programming every year - well, it is how I make the majority of my living these days
in any case.</p>

<p>(I lump Programming/CS in the same bucket, not because they are the same, but because
they fall within the same self-improvement bucket for me, so I’m studying both interchangeably
enough that I can consider them one thing).</p>

<p>In 2022, I spent about <code class="language-plaintext highlighter-rouge">347</code> hours studying CS, representing about 25% of the total
time spent self-improving in 2022. In that time, I did the following:</p>

<ul>
  <li>Engaged with four new languages during the year, <em>Ruby</em>, <em>Clojure</em>, <em>Haskell</em> and <em>Rust</em>.
    <ul>
      <li>Parts of this work immediately paid off - I engaged with a relatively big
piece of work in Rust at work, which was to build to expose a Rust-based
API for CBMC. The first PR is at <a href="https://github.com/diffblue/cbmc/pull/7410">cbmc#7410</a>.
        <ul>
          <li>I’m especially proud of my work in this project - the code represents my early
understanding of Rust, which I’m bound to look back over time and cringe, but
it was FFI work (i.e. very hard to debug) in a language that I had a cursory
understanding of, delivered in a very tight deadline (less than two sprints).</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Improved my understanding of testing, diving deeper into <em>TDD</em> and <em>Property-based testing</em>.</li>
  <li>Improved my understanding of <em>functional-design</em> and <em>object-oriented design</em>,
picking up on a couple of software-engineering and software-architecture books.</li>
  <li>Worked on a few compilers/interpreters written in a variety of languages
(Go, F# and C spring to mind).</li>
</ul>

<h3>Chemistry/Biology</h3>

<p>My long term aspirations is to found a biotech company. To that end, in 2022
I took big action towards advancing my scientific understanding of <strong>Biology</strong>.
That was accompanied by a lot of time spent studying <strong>Chemistry</strong> as well - the
fields seem to have a similar relationship to each other as do Computer Science
and Maths.</p>

<p>In <em>2022</em> I spent about <code class="language-plaintext highlighter-rouge">166</code> hours studying Biology and Chemistry (about 12% of
total self-improvement time) and in that time I:</p>

<ul>
  <li><a href="/2022/05/12/reflections-on-learning-how-to-grow-almost-anything/">Attended a synthetic biology course by MIT</a>,
which forced me to read and pick up a lot on molecular biology/chemistry at an
accelerated timeframe.
    <ul>
      <li>In the course’s final project, I focused on immunology, which is another subfield
of biology I ended up being fascinated of. Expect to hear more on this from me.</li>
    </ul>
  </li>
  <li>This was accompanied by a lot of hours spent on Khan Academy’s Chemistry/Biology
courses, as well as on Youtube, watching educational videos such as the ones by
the <a href="https://www.youtube.com/@AmoebaSisters">Amoeba Sisters</a>.
    <ul>
      <li>
        <p>As an aside, up until last year, I underestimated the value of Youtube, having
it associated with music/gamers/memes/lolcats in my mind, thinking it to be worthless
for any serious pursuit.</p>

        <p>Turns out I was wrong, and there’s some serious content creators there that
make your life significantly easier as you try to wrap yourself around some
complicated concepts. I wish I had discovered that earlier, though there’s only
myself to blame in this case.</p>
      </li>
    </ul>
  </li>
</ul>

<h3>Economics/Investing</h3>

<p>I started self-studying <strong>Economics</strong> and investing when I first moved to England,
some 5 years ago. I started studying it at that point because I felt like my
future job aspirations (Biotech founder) couldn’t be fulfilled without at least
a rudimentary understanding of economics, as I felt of a company as an entity
not existing within a vaccuum, but as something existing within a larger context,
the economy.</p>

<p>Years later, while I definitely feel that it’s true that a company is tied
to a macroeconomic context (much like Closures in programming are bound to the
enclosing environment), I’m not sure how much of an economics science understanding
a founder actually needs - but it turned out great for me personally, because I
found the way of thinking that economics promotes to have great synergy with my
CS/engineering education, along with how I like to think naturally.</p>

<p>At this point, I feel like my understanding of Economics is very robust (I would
like to think that I’m approaching, if I haven’t surpassed, the understanding of
a Economics undergraduate).</p>

<p>Despite this, I continue reading books and articles (which I haven’t been dilligent
in tracking, to be honest) in an effort to make my Economics mental models be
more robust.</p>

<p>Of course, it’s hard to study Economics without being at least made aware of
a sister field, <strong>Investing</strong>. This is my second love, in par with Economics. Because
of their close relationship, and how I utilise my knowledge within these fields
in my life right now, I consider them to fall within the same bucket.</p>

<ul>
  <li>Got a number of books read on Investing/Economics this year.</li>
  <li>Read an innumerable amount of articles on various media forms (papers, blog posts, etc).</li>
</ul>

<h3>Spanish</h3>

<p>Part of my self-improvement regime demands that I learn new languages, for a
number of reasons:</p>

<ol>
  <li>They help me become a more cultured and sophisticated person,</li>
  <li>They build me into a more round and multifaceted person instead of being
a one-trick-pony.</li>
  <li>Being able to speak multiple languages is an emblem of prowess in the self-improvement
circles - compared to other more superficial things, like say, wealth, noone can gift
you a foreign language. You have to put in the work to learn it. Hundreds of hours of it.
This (to me and others) commands a lot of respect, and generates a lot of confidence
and self respect.</li>
</ol>

<p>I had started with Spanish some years ago, primarily because my native tongue is Greek
and Spanish is very close to it, both from a phoneme (people mistake me for a Spaniard
when I do speak the little that I speak) and from a grammar standpoint.</p>

<p>This past year I committed to take it further, and I started learning Spanish again sometime
in Q1/22, and took the habit across all of 2022, spending a total of about 57 hours total
(about 4% of total) learning in a variety of ways (primarily through <a href="https://www.duolingo.com/profile/FotisKoutoulakis">Duolingo</a>,
but also using books and going to language exchange meetups.)</p>

<h3>Mathematics/Philosophy</h3>

<p>These two don’t fall within the same bucket for me from a self-improvement standpoint,
but I list them this way here because I’m at a point where I’m studying these purely
from an intellectual standpoint (I don’t do philosophy in any professional capacity,
and I appear to know enough Maths to get by professionally - though I’m always keen
to learn more.)</p>

<ul>
  <li>In both of these areas, many books/papers/exercises were read/done.</li>
</ul>

<h2>Music</h2>

<p>I keep no secret that one of my “side quests” in life is developing my musical
capabilities to the point where I could pursue a career as a professional musician.</p>

<p>This was a dream of mine ever since I was a teenager, and even though I was
taking singing lessons in the past, I never looked at music seriously enough
as a pursuit.</p>

<p>That was, until about 2020 and the beginning of the pandemic, when I bought
myself a small space piano just as the initial lockdowns were announced in
the U.K.</p>

<p>Ever since I have been spending a significant amount of time in developing
my music skills every year (about 20% of total), but in 2022 and going forward,
I want more time spent so that improvement is coming at an accelerated pace.</p>

<p>Highlights for 2022 include:</p>

<ul>
  <li>Establishment of more consistent practice habits for guitar and singing.</li>
  <li>Continuation of my piano practice.</li>
  <li>Deeper diving into music theory and a small initial foray into composition.</li>
</ul>

<h2>Fitness</h2>

<p>In terms of <strong>Fitness</strong>, 2022 was an about average year. No significant weight
swings, with my mass being in the range of 63-64kg, and I managed to keep a
relatively lean physique, of about 13-10% body fat ratio throughout the year
(with a kilo gain between some holiday periods, when I let myself loose for
a week or two).</p>

<p>In terms of the average day, both my diet and my fitness regime can be characterised
as <em>robust</em>, or at least <em>adequate</em> for my long term vision. Despite this,
however, a small effort had been put in enhancing my understanding and knowledge
around sports science and nutrition, with an aim of bringing a small improvement
on a going forward basis.</p>

<p>Given that my regime is robust as it stands, any improvements are not directly
observable, not at this point at least.</p>

<h2>Financial posture</h2>

<p>I opened 2022 having just closed (at the end of Dec 2021) a significant transaction
to acquire R&amp;G <code class="language-plaintext highlighter-rouge">Flutter</code>.</p>

<p>While this allowed for a number of benefits (as I have outlined in previous paragraphs),
it also had an unfortunate side effect of requiring massive capital outlays (at least
for my finances) and depleting liquidity sources, getting me to experience significant
cash crunches in early 2022.</p>

<p>Thankfully those subsided over time, as I adjusted to the new cash outflow regime, and
my cash flows improved due to a variety of reasons (raises at work, U.K government energy
subsidy-support, etc).</p>

<p>However, I also had to finance some furniture which ended up requiring significant percentage
of my cash flows into servicing debt in 2022. This has now subsided somewhat, primarilly
because the brunt of it has been paid, but there’s still some long term debt that’s not
completely of my books yet, and probably won’t be for the next 2-3 years.</p>

<p>I will also remiss not to mention that I did actually observe the inflationary spike eating
a bit into my discretionary income, around the summer time and onwards, which added some
further pressure.</p>

<p>In terms of other portfolios I had, despite having liquidated the majority of my holdings
to acquire <code class="language-plaintext highlighter-rouge">Flutter</code>, there was still exposure to the market conditions from some portfolios
that I can’t touch (say Workplace Pension, etc) and some illiquid portfolios (private holdings
through Crowdcube for instance), I was still a bit affected over the year in terms of total
net worth, which for the year remained flat (under most reasonable assumptions/mark to model).</p>

<p>This was a bit disappointing, as my finances are a relatively chunky picture of my life, and
one that I’m personally very proud of, but it would be naive not to expect some down years,
and to be completely honest, I have to be thankful that it remained this way and didn’t experience
significant losses.</p>

<p>On the plus side, the lack of progress on a financial front was counterbalanced by my
progress in other areas, so there was no psychological impact on me as well.</p>

<p>2022 was a colourful year as far as my financial posturing is concerned, with the following
highlights</p>

<ul>
  <li>Got depleted liquidity sources to be back up to a level considered adequate.</li>
  <li>Got to the point where I can start outlaying some cash for investments again.</li>
  <li>Started contributing more (%-wise) of my income to pension accounts.</li>
  <li>Started directing future investments into cash-flow producing assets, with
an aim to medium/long term have a dividend portfolio.</li>
</ul>

<h2>Conclusion</h2>

<p>This has been a long one, and I probably have to cut it short somewhere around here,
to preserve the interest of any reader and not bore them with details about my life.</p>

<p>All in all, I would call 2022 a fairly productive year, despite some of the headwinds
observed in some of the progress subdomains.</p>

<p>I will probably author another post laying out my aims for the year ahead.</p>

<p>For now, so long, and wish both you and me a most productive/successful 2023.</p>

        </div>
        
      </li>
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            
              <a class="post-link" href="/2022/06/12/couple-of-mental-models-software-complexity/">A Couple of Mental Models to Help Us Tackle Software Complexity</a>
            
          </h1>

          <p class="post-meta">
            Jun 12, 2022
            
              

 •
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/mental-models/">mental-models</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/software-design/">software-design</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  


            
            
          </p>
        </header>

        <div class="post-content">
          <p>Have you ever started designing your software while doing your best to keep the design
clean and simple, and still came up with a tangled mess? Read on for a small number of
mental models that might help you avoid this next time.</p>

<hr />

<h2>Everything’s in your head: A small introduction to Mental Models</h2>

<p>Excited yet? Me too.</p>

<p>But before we go on further with our discussion, let me introduce an appropriate definition
for <em>Mental Models</em>, just to make sure that we are all in the same page.</p>

<p><em>Mental models</em>, as their name suggests, are abstract mental representations of a wide variety of
topics. On a daily basis, we use mental models for everything: how we understand certain
events that happen around us, how we expect a certain object or the environment to respond
in our interactions with it, and a lot of other things.</p>

<p>They were first introduced by Charlie Munger (of Berkshire Hathaway) fame in a talk he
gave named <a href="https://fs.blog/great-talks/a-lesson-on-worldly-wisdom/">A Lesson on Elementary Worldly Wisdom</a>.</p>

<p>For more reading on Mental Models, I refer you to the excellent guide by <a href="https://fs.blog/mental-models/#what_are_mental_models">Farnam Street</a>,
which played a large part in popularising the idea of mental models (and familiarising me
with many of the ideas).</p>

<h3>Mental models and programming</h3>

<p>In programming (and computer science, more generally) mental models are everywhere.
Sometimes they are explicit (for instance, <a href="https://en.wikipedia.org/wiki/Model_of_computation"><em>Models of Computation</em></a>
are abstract representations of how humans or machines can perform a computation).
Other times, less so.</p>

<p>As an example, your knowledge of your favourite programming language is really a
just a model of it. Think of Python - you don’t really <em>know</em> Python.</p>

<p>Now, I can already picture you recoiling in disbelief. “How is that possible?”,
you ask. There’s something in your head that allows you to write programs
in Python, so my claim looks ridiculous upon surface examination.</p>

<p>Not so fast - I didn’t finish 😁</p>

<p>You don’t <em>know</em> Python - but what you do have in your head are two (partially?)
complete mental models of Python: a mental model of its syntax, and a mental
model of its semantics. You may also have mental models of the behaviour of
certain Python tools. You might also be very familiar with a number of different
libraries (e.g. <code class="language-plaintext highlighter-rouge">requests</code>), at which point you may have a very robust mental
model of its behaviour or the internal mechanisms that drive that behaviour.
You get the point.</p>

<h2>Our first model: The Function as an (Invisible) Machine</h2>

<p>In the two most well established models of computation the smallest unit of code
organisation is the <strong>function</strong>.</p>

<p>We software engineers deal with the abstract - we design software (write functions),
but for the most part, we see the end result of the computation they perform and
not much more. You can think of a function as an ethereal object (I stole this analogy
from <a href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-9.html"><em>Structure and Interpretation of Computer Programs</em></a>,
where the authors compare it to an “abstract being that inhabit computers”).</p>

<p>If we take the previous analogy, and ground it a bit into the more concrete idea
space, we can think of the function as the ethereal equivalent of <em>a machine</em>. It’s
really the digital equivalent of the machines other engineers are dealing with:
our machines have some <em>inputs</em> and are comprised of a different number of <em>components</em>,
the interplay of which produces <em>outputs</em>.</p>

<p>(This view aligns very well with ideas from the field of <em>Software Engineering</em> as well.)</p>

<p>If we admit that the analogy holds, then we are met with some pretty interesting implications.
For example, our ethereal machines share the following properties with concrete machines:</p>

<ul>
  <li>Complexity,</li>
  <li>Failure modes,</li>
  <li>Interfaces,</li>
  <li>Etc.</li>
</ul>

<h3>Simple machines - Complex Machines</h3>

<p>I’m going to stray away from computers for a moment so that I can make a point.</p>

<p>Think of a simple machine, say a <em>Bicycle</em>. A bicycle has some components (say,
it has a frame, tires, pedals, a handlebar, etc.) and performs a function,
namely, getting you from point A to point B.</p>

<p>There are other machines that are functionally equivalent from a high-level
standpoint, for example a <em>motocross bike</em>. These machines however are lot more
complex: they possess a greater number of components and features a greater number
of interactions between these components.</p>

<p>(Now, of course, the <em>motocross bike</em> offers functionality not present on the
<em>bicycle</em>, but that is beside the point I’m trying to make here.)</p>

<p>It should not be that much of a logical leap that the more complex machine
(with many more components and interactions) has more failure points than
the simpler machine. Not only that, but in the case of the simpler machine,
it takes less knowledge and effort to fix any failures.</p>

<p>Let’s hold that thought for a bit while we have a look at the second mental
model I wanted to talk about and go on to see how these two interplay with
each other.</p>

<h2>Bounded Rationality</h2>

<p>Enough talk about the machines - let’s now have a look at the human side of all this:
we are all affected by a cognitive bias known as <em>Bounded Rationality</em>.</p>

<p><em>Bounded rationality</em> is effectively a £10 word for describing the phenomenon of
some cognitive limitations, such as:</p>

<ul>
  <li>the lack of perfect information,</li>
  <li>the limited capacity of our <a href="https://www.simplypsychology.org/short-term-memory.html">short term memory</a>,</li>
  <li>the collapse of long-winded reasoning processes under a time limit or an informational
overload,</li>
  <li>the interplay between other cognitive biases, etc,</li>
</ul>

<p>negatively affecting our decision making process. The way the do that is by shifting
our decision making priority to be that of <em>satisficing</em> (aiming for just an adequate
outcome) instead of <em>optimising</em> (aiming for an optimal outcome).</p>

<p>This means that instead of going for the best solution in the current context,
we just go with the first one that seemingly satisfies the constraints that are
obvious to us at the moment.</p>

<p>You will see bounded rationality being discussed in different contexts. It is, however,
especially prevalent in behavioural economics (the field of study combining economics
and psychology), and cognitive science. The concept is more general, though, and is
relevant in any context that entails decision making.</p>

<p>When it comes to us, for the purposes of this article, we care about how bounded
rationality affects us when we design software, and this is what we’re going to
be focusing on from now on onwards.</p>

<h3>Bounded Rationality and Software Design</h3>

<p>At this point, an astute reader should be able to see where I am going with this:</p>

<blockquote>
  <p>A function should be as simple as possible so that we can avoid the pitfalls
associated with cognitive limitations on our end.</p>
</blockquote>

<p>You may have seen software design guidelines before that look like this:</p>

<ul>
  <li>“Limit the number of parameters a function accepts to less than 5”</li>
  <li>“Do not use global variables”</li>
  <li>“Use preconditions and postconditions”</li>
  <li>“Obey the <a href="https://en.wikipedia.org/wiki/Law_of_Demeter">Law of Demeter</a>”</li>
  <li>…</li>
</ul>

<p>All of these, from a high level standpoint, aim to narrow down the <em>size of
the set</em> of components and interactions of our function - our (invisible) machine.</p>

<p>Indeed, programming languages today include a number of features (static manifest typing,
lexical scope, etc) that limit the input, range of states and behaviour that our code
can find itself in.</p>

<p>This has a number of benefits relating to software correctness (as the compiler
enforces these constraints) but the biggest one is probably that it frees up
our mental capacity by making the function simpler. A smaller design space for
that function means less things that can cause us to throw our hands up and start
<em>satisficing</em>, and also less things that can go wrong or need fixing when we inevitably
make a mistake.</p>

<h2>Conclusion</h2>

<p>I hope that my small essay convinced you about the need to make functions as small
as possible (but not smaller 😁 ).</p>

<p>If you want a TL/DR of the whole article, it boils down to this:</p>

<blockquote>
  <p>The simpler your software design, the less likely your cognitive limitations are
going to negatively affect it.</p>
</blockquote>

        </div>
        
      </li>
    
      
      

      <li>
        <header class="post-header">
          <h1 class="post-title">
            
              <a class="post-link" href="/2022/06/02/three-versions-of-map/">Three (plus one) Different Versions of map in Haskell</a>
            
          </h1>

          <p class="post-meta">
            Jun 2, 2022
            
              

 •
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/fp/">fp</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/tags/haskell/">haskell</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  


            
            
          </p>
        </header>

        <div class="post-content">
          <p>If you are here, then <code class="language-plaintext highlighter-rouge">map</code> requires no introduction. You have seen it.
You have used it. Many times. You have even implemented it before. But did you
know that there are more than one ways to implement the function <code class="language-plaintext highlighter-rouge">map</code>?</p>

<hr />

<p>Of all the archetypal higher-order functions that I know, <code class="language-plaintext highlighter-rouge">map</code> is the function
that I hold dearest in my heart. That’s because it marked a very pleasant memory
when I finished <em>The Little Schemer</em> (for the first time, back in 2016) and I found
out that <a href="https://gist.github.com/NlightNFotis/b662a0368b5eea68ebfde1e4e4fb9787">I grokked the concept enough to be able to write it on my own</a>.</p>

<p>As a quick explainer, for the sake of completeness, <code class="language-plaintext highlighter-rouge">map</code> is a function that takes
two arguments, a function <code class="language-plaintext highlighter-rouge">fn</code> and a list <code class="language-plaintext highlighter-rouge">lat</code>, and produces a new list with the
elements being the result of the application of the function <code class="language-plaintext highlighter-rouge">fn</code> to the elements
of <code class="language-plaintext highlighter-rouge">lat</code> (in mathematical writing, this would be <code class="language-plaintext highlighter-rouge">∀x ∈ lat, fn(x)</code> - that is, for
all <code class="language-plaintext highlighter-rouge">x</code> that belong to <code class="language-plaintext highlighter-rouge">lat</code> we take the result of <code class="language-plaintext highlighter-rouge">fn</code> applied to <code class="language-plaintext highlighter-rouge">x</code>, <code class="language-plaintext highlighter-rouge">fn(x)</code>).</p>

<p>I always knew of the (<em>classic</em>?) way to define that in <code class="language-plaintext highlighter-rouge">Scheme</code> (or more generally,
in <code class="language-plaintext highlighter-rouge">Lisp</code>), which I had seen also being used in <code class="language-plaintext highlighter-rouge">OCaml</code>/<code class="language-plaintext highlighter-rouge">SML</code>, which looks like this:</p>

<div class="language-lisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="nv">define</span> <span class="p">(</span><span class="nb">map</span> <span class="nv">fn</span> <span class="nv">lat</span><span class="p">)</span>
  <span class="p">(</span><span class="nb">cond</span>
    <span class="p">((</span><span class="nv">null?</span> <span class="nv">lat</span><span class="p">)</span> <span class="o">'</span><span class="p">())</span>
    <span class="p">(</span><span class="nv">else</span>
     <span class="p">(</span><span class="nb">cons</span> <span class="p">(</span><span class="nv">fn</span> <span class="p">(</span><span class="nb">car</span> <span class="nv">lat</span><span class="p">))</span> <span class="p">(</span><span class="nb">map</span> <span class="nv">fn</span> <span class="p">(</span><span class="nb">cdr</span> <span class="nv">lat</span><span class="p">))))))</span>
</code></pre></div></div>

<p>That is, a recursive function definition, that does the following:</p>

<ul>
  <li>If the input list <code class="language-plaintext highlighter-rouge">lat</code> is empty, it returns the empty list <code class="language-plaintext highlighter-rouge">()</code> (we use that as the
base for <code class="language-plaintext highlighter-rouge">cons</code>structing a list of values), otherwise</li>
  <li>It returns the list <code class="language-plaintext highlighter-rouge">cons</code>tructed from the application of the function to the first
element of the list <code class="language-plaintext highlighter-rouge">(fn (car lat))</code> and the result of the recursive call on
the remaining list <code class="language-plaintext highlighter-rouge">(map fn (cdr lat))</code>.</li>
</ul>

<p>In OCaml, the same function would probably be defined using pattern matching, but
the pattern is the same:</p>

<div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="k">rec</span> <span class="n">map</span> <span class="n">fn</span> <span class="n">lat</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">lat</span> <span class="k">with</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="bp">[]</span>
  <span class="o">|</span> <span class="n">h</span><span class="o">::</span><span class="n">t</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">fn</span> <span class="n">h</span><span class="p">)</span><span class="o">::</span><span class="p">(</span><span class="n">map</span> <span class="n">fn</span> <span class="n">t</span><span class="p">)</span>
</code></pre></div></div>

<p>Recently though, I started reading Graham Hutton’s excellent <a href="https://www.cs.nott.ac.uk/~pszgmh/pih.html">Programming in Haskell</a>,
as a preparation for some more advanced material I wanted to read that required Haskell
knowledge.</p>

<p>In that book, I was delighted to find not one, not two, but <strong>three</strong> different ways of
defining the function <code class="language-plaintext highlighter-rouge">map</code> in Haskell.</p>

<p>Let’s have a look at the first two ways of defining <code class="language-plaintext highlighter-rouge">map</code> in Haskell, both defined in
chapter 7 of the book.</p>

<h2>The classical recursive definition of <code class="language-plaintext highlighter-rouge">map</code></h2>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">map</span> <span class="o">::</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">b</span><span class="p">]</span>
<span class="n">map</span> <span class="n">f</span> <span class="kt">[]</span>     <span class="o">=</span> <span class="kt">[]</span>
<span class="n">map</span> <span class="n">f</span> <span class="p">(</span><span class="n">x</span><span class="o">:</span><span class="n">xs</span><span class="p">)</span> <span class="o">=</span> <span class="n">f</span> <span class="n">x</span> <span class="o">:</span> <span class="n">map</span> <span class="n">f</span> <span class="n">xs</span>
</code></pre></div></div>

<p>The first definition is the one that is closest to what we described above for
both Scheme and OCaml. It’s the (structural) recursive definition using pattern
matching against two patterns:</p>

<ul>
  <li>The empty list in the first pattern <code class="language-plaintext highlighter-rouge">[]</code>, which as before returns the empty list,
and</li>
  <li>A pattern of a list with at least one element, which we immediately de-structure
into a <code class="language-plaintext highlighter-rouge">head</code> and <code class="language-plaintext highlighter-rouge">tail</code> component in <code class="language-plaintext highlighter-rouge">(x:xs)</code>. When matched, it will build a
<code class="language-plaintext highlighter-rouge">cons</code> (<code class="language-plaintext highlighter-rouge">:</code>) of the result of the function application <code class="language-plaintext highlighter-rouge">f x</code> and the result
of the recursive call of the remaining list (<code class="language-plaintext highlighter-rouge">map f xs</code>).</li>
</ul>

<p>This definition is basically the exact equivalent of the OCaml definition above,
with the only notable difference being the explicit function signature given:</p>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">map</span> <span class="o">::</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">b</span><span class="p">]</span>
</code></pre></div></div>

<p>This tells us that the <code class="language-plaintext highlighter-rouge">map</code> function takes two arguments:</p>

<ul>
  <li>A polymorphic function that maps elements of type <code class="language-plaintext highlighter-rouge">a</code> to type <code class="language-plaintext highlighter-rouge">b</code> <code class="language-plaintext highlighter-rouge">(a -&gt; b)</code>,</li>
  <li>A list of elements of type <code class="language-plaintext highlighter-rouge">a</code> (<code class="language-plaintext highlighter-rouge">[a]</code>)</li>
</ul>

<p>and as a result produces a list of elements of type <code class="language-plaintext highlighter-rouge">b</code> (<code class="language-plaintext highlighter-rouge">[b]</code>).</p>

<p>(The <code class="language-plaintext highlighter-rouge">a</code> and <code class="language-plaintext highlighter-rouge">b</code> above are called <em>type variables</em>, and are implicitly <em>universally
quantified</em>, i.e. they read as “for all elements of type <code class="language-plaintext highlighter-rouge">a</code>”).</p>

<p>So far, so classic.</p>

<p>Nothing out of the ordinary here.</p>

<h2>Let the show start: The list comprehension definition of <code class="language-plaintext highlighter-rouge">map</code></h2>

<p>Later on in the book, we come across this definition:</p>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">map</span> <span class="o">::</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">b</span><span class="p">]</span>
<span class="n">map</span> <span class="n">f</span> <span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="n">x</span> <span class="o">|</span> <span class="n">x</span> <span class="o">&lt;-</span> <span class="n">xs</span><span class="p">]</span>
</code></pre></div></div>

<p>Wow!</p>

<p>This one packs a punch in terms of conciseness, but I find it very elegant
and very expressive at the same time.</p>

<p>This definition is based in the syntax for <em>list comprehensions</em> in Haskell.</p>

<p>List comprehensions are a concise and convenient way to define new lists
by manipulating elements of other lists. As an example, consider the following:</p>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> <span class="p">[</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">|</span> <span class="n">x</span> <span class="o">&lt;-</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">25</span><span class="p">]</span>
</code></pre></div></div>

<p>This is read as make a list of “<code class="language-plaintext highlighter-rouge">x</code> squared, with <code class="language-plaintext highlighter-rouge">x</code> drawn from (<code class="language-plaintext highlighter-rouge">|</code>) the list
<code class="language-plaintext highlighter-rouge">[1, 2, 3, 4, 5]</code>.</p>

<p>Taking this into account, and back to our <code class="language-plaintext highlighter-rouge">map</code> function definition, our comprehension
there:</p>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">map</span> <span class="n">f</span> <span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="n">x</span> <span class="o">|</span> <span class="n">x</span> <span class="o">&lt;-</span> <span class="n">xs</span><span class="p">]</span>
</code></pre></div></div>

<p>reads as “make a list of the results of <code class="language-plaintext highlighter-rouge">f x</code>, where <code class="language-plaintext highlighter-rouge">x</code> is drawn from the list <code class="language-plaintext highlighter-rouge">xs</code>”.</p>

<p>Beautiful.</p>

<h2>Roll the carpet for Mr. Fold: The <code class="language-plaintext highlighter-rouge">foldr</code> definition of <code class="language-plaintext highlighter-rouge">map</code></h2>

<p>One of the coolest things the book opened my eyes to was the fact that we can
use a <code class="language-plaintext highlighter-rouge">fold</code> in a generative fashion.</p>

<p>I was well aware of <code class="language-plaintext highlighter-rouge">fold</code> from both Racket and OCaml before, but I always thought
of that in terms of a generalisation of <code class="language-plaintext highlighter-rouge">reduce</code> - it never occured to me that
I can use the accumulating function to yield a value in a generative recursion
fashion, like a new list 🤯</p>

<p>(Embarassingly, it now looks kind of obvious, and related to ideas I’ve been exposed
to in the past - this one is related to the <code class="language-plaintext highlighter-rouge">collector functions</code> idea that the <a href="https://mitpress.mit.edu/books/little-schemer-fourth-edition">Little
Schemer</a> uses in chapter 8).</p>

<p>Back to our definition.</p>

<p>This one is not given by the book - in fact, it’s left for the reader to define as one
of the exercises. This is what I came up with:</p>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">map</span> <span class="o">::</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">b</span><span class="p">]</span>
<span class="n">map</span> <span class="n">f</span> <span class="o">=</span> <span class="n">foldr</span> <span class="p">(</span><span class="nf">\</span> <span class="n">x</span> <span class="n">xs</span> <span class="o">-&gt;</span> <span class="n">f</span> <span class="n">x</span> <span class="o">:</span> <span class="n">xs</span><span class="p">)</span> <span class="kt">[]</span>
</code></pre></div></div>

<p>This definition is the one that left me most stunned and amazed with the generalising
power of a fold.</p>

<p>What this definition tells us is that we define <code class="language-plaintext highlighter-rouge">map</code> as a right fold (<code class="language-plaintext highlighter-rouge">foldr</code>)
of a lambda that takes two arguments, <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">xs</code>, and <code class="language-plaintext highlighter-rouge">returns</code> the cons of <code class="language-plaintext highlighter-rouge">f x</code>
and <code class="language-plaintext highlighter-rouge">xs</code>. The last value we pass to the <code class="language-plaintext highlighter-rouge">foldr</code> is the empty list <code class="language-plaintext highlighter-rouge">[]</code>, which is the
value that is used as the base case.</p>

<p>In order to understand what the <code class="language-plaintext highlighter-rouge">foldr</code> does, I find the following visual from
<a href="https://en.wikipedia.org/wiki/Fold_(higher-order_function)">Wikipedia</a> to be
very helpful:</p>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/3/3e/Right-fold-transformation.png" alt="foldr visualisation" /></p>

<p>To understand the above visualisation, you need to understand that a list in Haskell
(and most functional programming languages for that matter), is a <code class="language-plaintext highlighter-rouge">cons</code> of various
values and the empty list. I.e. you can think of <code class="language-plaintext highlighter-rouge">[1, 2, 3, 4, 5]</code> as
<code class="language-plaintext highlighter-rouge">1 : (2 : (3 : (4 : (5 : []))))</code>.</p>

<p>With that in mind, what the <code class="language-plaintext highlighter-rouge">foldr</code> function does is that replaces the <code class="language-plaintext highlighter-rouge">cons</code> (<code class="language-plaintext highlighter-rouge">:</code>)
operator with the function argument supplied to it, and <em>reduces</em> it all (<em>folds the
list</em>) into a single value.</p>

<p>(It also replaces the base case empty list value <code class="language-plaintext highlighter-rouge">[]</code> with the value of the last
argument supplied to it. In our case, we are passing the empty list (<code class="language-plaintext highlighter-rouge">[]</code>) again,
which we are going to use as a base to build a new list of values on top of.)</p>

<p>And here’s the trick - because the (anonymous) function we passed to it is building
a new list (by applying the <code class="language-plaintext highlighter-rouge">cons</code> operator again), what we end up is a new list instead
of just a single value!</p>

<p>In our case, this means that if we had the list:</p>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">1</span> <span class="o">:</span> <span class="p">(</span><span class="mi">2</span> <span class="o">:</span> <span class="p">(</span><span class="mi">3</span> <span class="o">:</span> <span class="p">(</span><span class="mi">4</span> <span class="o">:</span> <span class="p">(</span><span class="mi">5</span> <span class="o">:</span> <span class="kt">[]</span><span class="p">))))</span>
</code></pre></div></div>

<p>after the application of the anonymous function we would have a new list, equivalent to</p>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span> <span class="mi">1</span> <span class="o">:</span> <span class="p">(</span><span class="n">f</span> <span class="mi">2</span> <span class="o">:</span> <span class="p">(</span><span class="n">f</span> <span class="mi">3</span> <span class="o">:</span> <span class="p">(</span><span class="n">f</span> <span class="mi">4</span> <span class="o">:</span> <span class="p">(</span><span class="n">f</span> <span class="mi">5</span> <span class="o">:</span> <span class="kt">[]</span><span class="p">))))</span>
</code></pre></div></div>

<p>🤯</p>

<h3>Bonus round: a monadic definition of <code class="language-plaintext highlighter-rouge">map</code></h3>

<p>Okay, this is a bit of a cheat because this is basically our first definition, except
that the function and the return type are monadic:</p>

<div class="language-hs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mapM</span> <span class="o">::</span> <span class="kt">Monad</span> <span class="n">m</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">m</span> <span class="n">b</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">-&gt;</span> <span class="n">m</span> <span class="p">[</span><span class="n">b</span><span class="p">]</span>
<span class="n">mapM</span> <span class="n">f</span> <span class="kt">[]</span>     <span class="o">=</span> <span class="n">return</span> <span class="kt">[]</span>
<span class="n">mapM</span> <span class="n">f</span> <span class="p">(</span><span class="n">x</span><span class="o">:</span><span class="n">xs</span><span class="p">)</span> <span class="o">=</span> <span class="kr">do</span> <span class="n">y</span> <span class="o">&lt;-</span> <span class="n">f</span> <span class="n">x</span>
                   <span class="n">ys</span> <span class="o">&lt;-</span> <span class="n">mapM</span> <span class="n">f</span> <span class="n">xs</span>
                   <span class="n">return</span> <span class="p">(</span><span class="n">y</span> <span class="o">:</span> <span class="n">ys</span><span class="p">)</span>
</code></pre></div></div>

<p>This is using the <a href="https://en.wikibooks.org/wiki/Haskell/do_notation"><code class="language-plaintext highlighter-rouge">do</code> notation to define a sequence of actions</a>,
but the actions themselves have a near 1-1 correspondence to our original map implementation:</p>

<ul>
  <li>First we assign the name <code class="language-plaintext highlighter-rouge">y</code> to the result of <code class="language-plaintext highlighter-rouge">f x</code>, then</li>
  <li>We assign the name <code class="language-plaintext highlighter-rouge">ys</code> to the result of the recursive call on the
of the list (<code class="language-plaintext highlighter-rouge">mapM f xs</code>)</li>
  <li>And the return the <code class="language-plaintext highlighter-rouge">cons</code> of the two values <code class="language-plaintext highlighter-rouge">(y : ys)</code></li>
</ul>

<p>How is this definition useful?</p>

<p>You may have observed that the return type is <code class="language-plaintext highlighter-rouge">m [b]</code> - a monadic list of type <code class="language-plaintext highlighter-rouge">b</code>.</p>

<p>Consider the following: we want a function that converts a string into a list only
if all of the string characters correspond to a digit, or fail gracefully otherwise.</p>

<p>One way to do that is to write a function to convert a single character into a
<code class="language-plaintext highlighter-rouge">Maybe Int</code>:</p>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">conv</span> <span class="o">::</span> <span class="kt">Char</span> <span class="o">-&gt;</span> <span class="kt">Maybe</span> <span class="kt">Int</span>
<span class="n">conv</span> <span class="n">c</span> <span class="o">|</span> <span class="n">isDigit</span> <span class="n">c</span> <span class="o">=</span> <span class="kt">Just</span> <span class="p">(</span><span class="n">digitToInt</span> <span class="n">c</span><span class="p">)</span>
       <span class="o">|</span> <span class="n">otherwise</span> <span class="o">=</span> <span class="kt">Nothing</span>
</code></pre></div></div>

<p>With this definition, we can now use our function <code class="language-plaintext highlighter-rouge">mapM</code> like this:</p>

<div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> <span class="n">mapM</span> <span class="n">conv</span> <span class="s">"1234"</span>
<span class="kt">Just</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>

<span class="o">&gt;</span> <span class="n">mapM</span> <span class="n">conv</span> <span class="s">"123a"</span>
<span class="kt">Nothing</span>
</code></pre></div></div>

<h2>Conclusion</h2>

<p>I enjoyed writing this post quite a bit.</p>

<p>It’s a very humbling experience to be visiting books and seeing that ideas that you considered
to be elementary and rather surface-level are a lot more nuanced once you start digging deeper
into them.</p>

<p>It’s something I need to keep top of mind as I go forward as well.</p>

<p>This post also highlights one of the nice things of going for breadth of knowledge: exposure
to a wider set of ideas. Had I only stayed in the Racket/OCaml realm, I probably wouldn’t have
been exposed to this range of <code class="language-plaintext highlighter-rouge">map</code> implementations, for the reason that these languages don’t
offer some of the language features that enable them, like list comprehensions.</p>

<p>All in all, happy I went down this path, and looking forward to what’s next.</p>

        </div>
        
      </li>
    
  </ul>

  
  <div class="pagination">
    
      <a class="previous" href="/posts/2/">&laquo; Older</a>
    

    
  </div>



</div>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <p>
      

&copy; Fotis Koutoulakis - Powered by <a href="https://jekyllrb.com">Jekyll</a> &amp; <a href="https://github.com/yous/whiteglass">whiteglass</a> - Subscribe via <a href="https://nlightnfotis.github.io/feed.xml">RSS</a>

    </p>

  </div>

</footer>


  </body>

</html>
